<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Dumber LLM Agents Need More Constraints and Better Tools — LlamaIndex - Build Knowledge Assistants over your Enterprise Data</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><meta name="title" content="Dumber LLM Agents Need More Constraints and Better Tools — LlamaIndex - Build Knowledge Assistants over your Enterprise Data"/><meta name="description" content="LlamaIndex is a simple, flexible framework for building knowledge assistants using LLMs connected to your enterprise data."/><meta property="og:title" content="Dumber LLM Agents Need More Constraints and Better Tools — LlamaIndex - Build Knowledge Assistants over your Enterprise Data"/><meta property="og:description" content="LlamaIndex is a simple, flexible framework for building knowledge assistants using LLMs connected to your enterprise data."/><meta property="og:image" content="https://cdn.sanity.io/images/7m9jw85w/production/51fec5920633a3007410529f10af91223e39f371-3343x1465.png"/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:title" content="Dumber LLM Agents Need More Constraints and Better Tools — LlamaIndex - Build Knowledge Assistants over your Enterprise Data"/><meta property="twitter:description" content="LlamaIndex is a simple, flexible framework for building knowledge assistants using LLMs connected to your enterprise data."/><meta property="twitter:image" content="https://cdn.sanity.io/images/7m9jw85w/production/51fec5920633a3007410529f10af91223e39f371-3343x1465.png"/><link rel="alternate" type="application/rss+xml" href="https://www.llamaindex.ai/blog/feed"/><meta name="next-head-count" content="20"/><script>
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WWRFB36R');
            </script><link rel="preload" href="/_next/static/css/41c9222e47d080c9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/41c9222e47d080c9.css" data-n-g=""/><link rel="preload" href="/_next/static/css/97c33c8d95f1230e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/97c33c8d95f1230e.css" data-n-p=""/><link rel="preload" href="/_next/static/css/e009059e80bf60c5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e009059e80bf60c5.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-1b629d9c8fb16f34.js" defer=""></script><script src="/_next/static/chunks/framework-df1f68dff096b68a.js" defer=""></script><script src="/_next/static/chunks/main-eca7952a704663f8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c7c49437be49d2ad.js" defer=""></script><script src="/_next/static/chunks/d9067523-4985945b21298365.js" defer=""></script><script src="/_next/static/chunks/41155975-60c12da9ce9fa0b2.js" defer=""></script><script src="/_next/static/chunks/cb355538-cee2ea45674d9de3.js" defer=""></script><script src="/_next/static/chunks/9494-dff62cb53535dd7d.js" defer=""></script><script src="/_next/static/chunks/4063-39a391a51171ff87.js" defer=""></script><script src="/_next/static/chunks/6889-edfa85b69b88a372.js" defer=""></script><script src="/_next/static/chunks/5575-11ee0a29eaffae61.js" defer=""></script><script src="/_next/static/chunks/3444-95c636af25a42734.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-82c8e764e69afd2c.js" defer=""></script><script src="/_next/static/C8J-EMc_4OCN1ch65l4fl/_buildManifest.js" defer=""></script><script src="/_next/static/C8J-EMc_4OCN1ch65l4fl/_ssgManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WWRFB36R" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="__variable_d65c78 __variable_b1ea77 __variable_eb7534"><a class="Announcement_announcement__2ohK8" href="http://48755185.hs-sites.com/llamaindex-0">Meet LlamaIndex at the Databricks Data + AI Summit!<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M8.293 5.293a1 1 0 0 1 1.414 0l6 6a1 1 0 0 1 0 1.414l-6 6a1 1 0 0 1-1.414-1.414L13.586 12 8.293 6.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></a><header class="Header_header__hO3lJ"><button class="Hamburger_hamburger__17auO Header_hamburger__lUulX"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 14H24.5" stroke="#212121" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="hamburger-stroke-top" class="Hamburger_hamburgerStrokeMiddle__I7VpD"></path><path d="M3.5 7H24.5" stroke="#212121" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="Hamburger_hamburgerStrokeTop__oOhFM"></path><path d="M3.5 21H24.5" stroke="#212121" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="Hamburger_hamburgerStrokeBottom__GIQR2"></path></svg></button><a aria-label="Homepage" href="/"><img alt="LlamaIndex" loading="lazy" width="213" height="42" decoding="async" data-nimg="1" class="Header_logo__e5KhT" style="color:transparent" src="/llamaindex.svg"/></a><nav aria-label="Main" data-orientation="horizontal" dir="ltr" style="--content-position:0px"><div style="position:relative"><ul data-orientation="horizontal" class="Nav_MenuList__PrCDJ" dir="ltr"><li><button id="radix-:R6tm:-trigger-radix-:R5mtm:" data-state="closed" aria-expanded="false" aria-controls="radix-:R6tm:-content-radix-:R5mtm:" class="Nav_Trigger__ws43x" data-radix-collection-item="">Products</button></li><li><button id="radix-:R6tm:-trigger-radix-:R9mtm:" data-state="closed" aria-expanded="false" aria-controls="radix-:R6tm:-content-radix-:R9mtm:" class="Nav_Trigger__ws43x" data-radix-collection-item="">Solutions</button></li><li><a class="Nav_Link__ZrzFc" href="/community" data-radix-collection-item="">Community</a></li><li><a class="Nav_Link__ZrzFc" href="/pricing" data-radix-collection-item="">Pricing</a></li><li><a class="Nav_Link__ZrzFc" href="/blog" data-radix-collection-item="">Blog</a></li><li><a class="Nav_Link__ZrzFc" href="/customers" data-radix-collection-item="">Customer stories</a></li><li><a class="Nav_Link__ZrzFc" href="/careers" data-radix-collection-item="">Careers</a></li></ul></div><div class="Nav_ViewportPosition__jmyHM"></div></nav><div class="Header_secondNav__YJvm8"><nav><a href="/contact" class="Link_link__71cl8 Link_link-variant-tertiary__BYxn_ Header_bookADemo__qCuxV">Book a demo</a></nav><a href="https://cloud.llamaindex.ai/" class="Button_button-variant-default__Oi__n Button_button__aJ0V6 Header_button__1HFhY" data-tracking-variant="default"> <!-- -->Get started</a></div><div class="MobileMenu_mobileMenu__g5Fa6"><nav class="MobileMenu_nav__EmtTw"><ul><li><details class="MobileMenu_ListItem__yMtVi"><summary class="MobileMenu_ListItemHeading___yPC6">Products<!-- --> <span class="MobileMenu_icon__6gmaF"><svg width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 1L5.5 5L1 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></summary><ul class="MobileMenu_List__XjJr0"><li><a class="MobileMenu_ListItemLink__dnvmV" href="/llamaparse"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.6654 1.66675V6.66675H16.6654M8.33203 10.8334L6.66536 12.5001L8.33203 14.1667M11.6654 14.1667L13.332 12.5001L11.6654 10.8334M12.082 1.66675H4.9987C4.55667 1.66675 4.13275 1.84234 3.82019 2.1549C3.50763 2.46746 3.33203 2.89139 3.33203 3.33341V16.6667C3.33203 17.1088 3.50763 17.5327 3.82019 17.8453C4.13275 18.1578 4.55667 18.3334 4.9987 18.3334H14.9987C15.4407 18.3334 15.8646 18.1578 16.1772 17.8453C16.4898 17.5327 16.6654 17.1088 16.6654 16.6667V6.25008L12.082 1.66675Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Document parsing</div><p class="MobileMenu_ListItemText__n_MHY">The first and leading GenAI-native parser over your most complex data.</p></a></li><li><a class="MobileMenu_ListItemLink__dnvmV" href="/llamaextract"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.668 1.66675V5.00008C11.668 5.44211 11.8436 5.86603 12.1561 6.17859C12.4687 6.49115 12.8926 6.66675 13.3346 6.66675H16.668M3.33464 5.83341V3.33341C3.33464 2.89139 3.51023 2.46746 3.82279 2.1549C4.13535 1.84234 4.55927 1.66675 5.0013 1.66675H12.5013L16.668 5.83341V16.6667C16.668 17.1088 16.4924 17.5327 16.1798 17.8453C15.8672 18.1578 15.4433 18.3334 15.0013 18.3334L5.05379 18.3326C4.72458 18.3755 4.39006 18.3191 4.09312 18.1706C3.79618 18.0221 3.55034 17.7884 3.38713 17.4992M4.16797 9.16675L1.66797 11.6667M1.66797 11.6667L4.16797 14.1667M1.66797 11.6667H10.0013" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Data extraction</div><p class="MobileMenu_ListItemText__n_MHY">Extract structured data from documents using a schema-driven engine.</p></a></li><li><a class="MobileMenu_ListItemLink__dnvmV" href="/enterprise"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.16667 15.8333C12.8486 15.8333 15.8333 12.8486 15.8333 9.16667C15.8333 5.48477 12.8486 2.5 9.16667 2.5C5.48477 2.5 2.5 5.48477 2.5 9.16667C2.5 12.8486 5.48477 15.8333 9.16667 15.8333Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M17.5 17.5L13.875 13.875" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Knowledge Management</div><p class="MobileMenu_ListItemText__n_MHY">Connect, transform, and index your enterprise data into an agent-accessible knowledge base</p></a></li><li><a class="MobileMenu_ListItemLink__dnvmV" href="/framework"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.0013 6.66659V3.33325H6.66797M1.66797 11.6666H3.33464M16.668 11.6666H18.3346M12.5013 10.8333V12.4999M7.5013 10.8333V12.4999M5.0013 6.66659H15.0013C15.9218 6.66659 16.668 7.41278 16.668 8.33325V14.9999C16.668 15.9204 15.9218 16.6666 15.0013 16.6666H5.0013C4.08083 16.6666 3.33464 15.9204 3.33464 14.9999V8.33325C3.33464 7.41278 4.08083 6.66659 5.0013 6.66659Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Agent Framework</div><p class="MobileMenu_ListItemText__n_MHY">Orchestrate and deploy multi-agent applications over your data with the #1 agent framework.</p></a></li></ul></details></li><li><details class="MobileMenu_ListItem__yMtVi"><summary class="MobileMenu_ListItemHeading___yPC6">Solutions<!-- --> <span class="MobileMenu_icon__6gmaF"><svg width="11" height="6" viewBox="0 0 11 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 1L5.5 5L1 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></summary><ul class="MobileMenu_List__XjJr0"><li><a class="MobileMenu_ListItemLink__dnvmV" href="/solutions/finance"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.3307 6.66675H8.33073C7.8887 6.66675 7.46478 6.84234 7.15222 7.1549C6.83966 7.46746 6.66406 7.89139 6.66406 8.33342C6.66406 8.77544 6.83966 9.19937 7.15222 9.51193C7.46478 9.82449 7.8887 10.0001 8.33073 10.0001H11.6641C12.1061 10.0001 12.53 10.1757 12.8426 10.4882C13.1551 10.8008 13.3307 11.2247 13.3307 11.6667C13.3307 12.1088 13.1551 12.5327 12.8426 12.8453C12.53 13.1578 12.1061 13.3334 11.6641 13.3334H6.66406M9.9974 15.0001V5.00008M18.3307 10.0001C18.3307 14.6025 14.5998 18.3334 9.9974 18.3334C5.39502 18.3334 1.66406 14.6025 1.66406 10.0001C1.66406 5.39771 5.39502 1.66675 9.9974 1.66675C14.5998 1.66675 18.3307 5.39771 18.3307 10.0001Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Financial Analysts</div></a></li><li><a class="MobileMenu_ListItemLink__dnvmV" href="/solutions/administrative-operations"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.66406 6.66659V15.8333C1.66406 16.2753 1.83966 16.6992 2.15222 17.0118C2.46478 17.3243 2.8887 17.4999 3.33073 17.4999H14.9974M16.6641 14.1666C17.1061 14.1666 17.53 13.991 17.8426 13.6784C18.1551 13.3659 18.3307 12.9419 18.3307 12.4999V7.49992C18.3307 7.05789 18.1551 6.63397 17.8426 6.32141C17.53 6.00885 17.1061 5.83325 16.6641 5.83325H13.4141C13.1353 5.83598 12.8604 5.76876 12.6143 5.63774C12.3683 5.50671 12.159 5.31606 12.0057 5.08325L11.3307 4.08325C11.179 3.85281 10.9724 3.66365 10.7295 3.53275C10.4866 3.40185 10.215 3.3333 9.93906 3.33325H6.66406C6.22204 3.33325 5.79811 3.50885 5.48555 3.82141C5.17299 4.13397 4.9974 4.55789 4.9974 4.99992V12.4999C4.9974 12.9419 5.17299 13.3659 5.48555 13.6784C5.79811 13.991 6.22204 14.1666 6.66406 14.1666H16.6641Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Administrative Operations</div></a></li><li><a class="MobileMenu_ListItemLink__dnvmV" href="/solutions/engineering"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.3307 15L18.3307 10L13.3307 5M6.66406 5L1.66406 10L6.66406 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Engineering &amp; R&amp;D</div></a></li><li><a class="MobileMenu_ListItemLink__dnvmV" href="/solutions/customer-support"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.9974 7.50008H16.6641C17.1061 7.50008 17.53 7.67568 17.8426 7.98824C18.1551 8.3008 18.3307 8.72472 18.3307 9.16675V18.3334L14.9974 15.0001H9.9974C9.55537 15.0001 9.13145 14.8245 8.81888 14.5119C8.50632 14.1994 8.33073 13.7754 8.33073 13.3334V12.5001M11.6641 7.50008C11.6641 7.94211 11.4885 8.36603 11.1759 8.67859C10.8633 8.99115 10.4394 9.16675 9.9974 9.16675H4.9974L1.66406 12.5001V3.33341C1.66406 2.41675 2.41406 1.66675 3.33073 1.66675H9.9974C10.4394 1.66675 10.8633 1.84234 11.1759 2.1549C11.4885 2.46746 11.6641 2.89139 11.6641 3.33341V7.50008Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Customer Support</div></a></li><li><a class="MobileMenu_ListItemLink__dnvmV" href="/solutions/healthcare-pharma"><div class="MobileMenu_ListItemHeading___yPC6"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17.0128 3.81671C16.5948 3.39719 16.098 3.06433 15.551 2.8372C15.004 2.61008 14.4176 2.49316 13.8253 2.49316C13.2331 2.49316 12.6466 2.61008 12.0996 2.8372C11.5527 3.06433 11.0559 3.39719 10.6378 3.81671L9.99617 4.46671L9.3545 3.81671C8.93643 3.39719 8.43967 3.06433 7.89268 2.8372C7.3457 2.61008 6.75926 2.49316 6.167 2.49316C5.57474 2.49316 4.9883 2.61008 4.44132 2.8372C3.89433 3.06433 3.39756 3.39719 2.9795 3.81671C1.21283 5.58338 1.1045 8.56671 3.3295 10.8334L9.99617 17.5L16.6628 10.8334C18.8878 8.56671 18.7795 5.58338 17.0128 3.81671Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.91406 9.99992H7.91406L8.33073 9.16659L9.9974 12.9166L11.6641 7.08325L12.9141 9.99992H17.0807" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>Healthcare / Pharma</div></a></li></ul></details></li><li><a class="MobileMenu_Link__5frcx" href="/community">Community</a></li><li><a class="MobileMenu_Link__5frcx" href="/pricing">Pricing</a></li><li><a class="MobileMenu_Link__5frcx" href="/blog">Blog</a></li><li><a class="MobileMenu_Link__5frcx" href="/customers">Customer stories</a></li><li><a class="MobileMenu_Link__5frcx" href="/careers">Careers</a></li></ul></nav><a href="/contact" class="Button_button-variant-ghost__o2AbG Button_button__aJ0V6" data-tracking-variant="ghost"> <!-- -->Talk to us</a><ul class="Socials_socials__8Y_s5 Socials_socials-theme-dark__Hq8lc MobileMenu_socials__JykCO"><li><a href="https://github.com/run-llama/llama_index"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li><a href="https://discord.com/invite/eN6D2HQ4aX"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 640 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"></path></svg></a></li><li><a href="https://twitter.com/llama_index"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></a></li><li><a href="https://www.linkedin.com/company/91154103/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li><a href="https://www.youtube.com/@LlamaIndex"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li></ul><p class="Text_text__zPO0D Text_text-size-16__PkjFu MobileMenu_copyright__nKVOs">© <!-- -->2025<!-- --> LlamaIndex</p></div></header><main><section class="BlogPost_post__JHNzd"><img alt="" loading="lazy" width="800" height="732.5" decoding="async" data-nimg="1" class="BlogPost_featuredImage__KGxwX" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F51fec5920633a3007410529f10af91223e39f371-3343x1465.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F51fec5920633a3007410529f10af91223e39f371-3343x1465.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=1920&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F51fec5920633a3007410529f10af91223e39f371-3343x1465.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=1920&amp;q=75"/><p class="Text_text__zPO0D Text_text-size-16__PkjFu Text_text-weight-600__fKYth BlogPost_date__6uxQw"><a class="BlogPost_author__mesdl" href="/blog/author/jerry-liu">Jerry Liu</a> <!-- -->•<!-- --> <!-- -->2023-05-23</p><h1 class="Text_text__zPO0D Text_text-size-32__koGps BlogPost_title__b2lqJ">Dumber LLM Agents Need More Constraints and Better Tools</h1><ul class="BlogPost_tags__13pBH"><li><a class="Badge_badge___1ssn" href="/blog/tag/artificial-intelligence"><span class="Text_text__zPO0D Text_text-size-16__PkjFu Text_text-weight-500__f2npw">Artificial Intelligence</span></a></li><li><a class="Badge_badge___1ssn" href="/blog/tag/large-language-models"><span class="Text_text__zPO0D Text_text-size-16__PkjFu Text_text-weight-500__f2npw">Large Language Models</span></a></li><li><a class="Badge_badge___1ssn" href="/blog/tag/nlp"><span class="Text_text__zPO0D Text_text-size-16__PkjFu Text_text-weight-500__f2npw">NLP</span></a></li><li><a class="Badge_badge___1ssn" href="/blog/tag/machine-learning"><span class="Text_text__zPO0D Text_text-size-16__PkjFu Text_text-weight-500__f2npw">Machine Learning</span></a></li></ul><div class="BlogPost_htmlPost__Z5oDL"><h1>Summary</h1><p>In this article, we compare how well LLM-powered agents with different degrees of complexity perform over practical data tasks (financial analysis). We compare the performance of agents with more <em class="ow">complex, unrestrained </em>interaction behavior (ReAct) with agents that contain <em class="ow">simpler, more constrained </em>interactions (routing). We specifically analyze how much complexity can be added to the agent layer vs. the tool layer.</p><p>We find that the choice of the language model matters a lot. ReAct agents that are powered by “dumber” models (in a tongue-in-cheek fashion we are referring to any non GPT-4 model as “dumb”) struggle to return relevant results over data. We find that constraining agent interaction behavior, and giving them access to more tools that can more explicitly perform complex actions, can help improve query performance over these less sophisticated LLMs. In contrast, more sophisticated models (GPT-4) can more reliably utilize the ReAct loop to execute a variety of complex data queries.</p><p>This blog post is quite detailed; we provide a <em class="ow">lot </em>of experiments and results below. Best of all, you can run this all yourself with our <a href="https://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing" rel="noopener ugc nofollow" target="_blank">example notebook</a>!</p><h1>Overview of Agents</h1><p>Building LLM-powered agents have gotten increasingly popular in the past few months. Frameworks like <a href="https://github.com/hwchase17/langchain" rel="noopener ugc nofollow" target="_blank">LangChain</a> have made it much easier to create these agents according to a set of common abstractions.</p><p>At a high-level, an “agent” is essentially an automated decision engine, that can be used to interact with an external environment. The core agent loop looks something like the following:</p><ol><li>The agent has access to a set of “tools”, which are generic functions that it can perform. It has an awareness of each tool through some attached metadata, and it can call each tool (either as a function call or structured API).</li><li>User feeds in a natural language input to the agent.</li><li>Given the input, the agent <strong>interacts with the set of tools </strong>in some fashion and returns the response.</li></ol><p>There’s a variety of ways to perform <strong>agent-tool interaction.</strong></p><ul><li>The most popular is probably <a href="https://arxiv.org/abs/2210.03629" rel="noopener ugc nofollow" target="_blank">ReAct</a>: the agent reasons over the next action, constructs an action command, executes the action. It repeats these steps in an iterative loop until the task is complete.</li><li>There are other interaction modes too. Recently there was a paper on <a href="https://arxiv.org/pdf/2305.04091.pdf" rel="noopener ugc nofollow" target="_blank">Plan-and-solve Prompting</a>, which generates a plan beforehand (to decompose a complex task into simpler ones). Before ReAct there have also been related techniques on <a href="https://arxiv.org/abs/2210.03350" rel="noopener ugc nofollow" target="_blank">Self-Ask</a> and <a href="https://arxiv.org/abs/2201.11903" rel="noopener ugc nofollow" target="_blank">Chain of Thought Prompting</a>.</li></ul><h2>“Complex” vs. “Simple” Agent Interaction Techniques</h2><p>We classify techniques like ReAct are more <em class="ow">complex and unconstrained: </em>this is because they perform iterative reasoning and also break the input into smaller steps. Complicated agent interaction loops allow for more <em class="ow">freedom of behavior, </em>and<em class="ow"> </em>create an increased burden on the LLM being used. The pro of complex interaction frameworks is that they can be more general and handle a broader class of queries over simple tools. The con is that if the LLM is not up to par, then these frameworks are prone to making mistakes; unconstrained behavior can lead to unexpected results.</p><p>On the other end of the spectrum, you can imagine a <em class="ow">simple and constrained </em>agent interaction mechanism, where the agent does one-step selection of the underlying tool to use, and returns the response from the tool. The agent essentially just acts as a router from the query to Tool. There are no steps to break down the question into smaller ones, and no iterative chain-of-thought loops. The pro here is that the model will likely make fewer errors. The con here is that the interaction technique allows for less freedom and imposes more constraints on behavior.</p><h2>Investigating Agent Interaction Techniques for Data Querying</h2><p>We at LlamaIndex are interested in how agents can help augment data tasks. More specifically, we are interested in how agents can help perform complex user queries over a diverse range of data sources. This includes not only asking questions over a single document, but being able to synthesize insights across multiple documents and return that to the user.</p><p>LlamaIndex query engines can be used as Tools within an agent construct to query your data (we provide <a href="https://gpt-index.readthedocs.io/en/latest/how_to/integrations/using_with_langchain.html" rel="noopener ugc nofollow" target="_blank">seamless integrations with LangChain</a>). These Tools can vary in complexity. For instance, a <em class="ow">simple </em>Tool could be our <a href="https://gpt-index.readthedocs.io/en/latest/how_to/integrations/vector_stores.html" rel="noopener ugc nofollow" target="_blank">vector store query engine</a>, which does top-k embedding retrieval from a vector store. A more <em class="ow">advanced</em> tool could be a query engine over our graph data structure, which can be setup to <a href="https://gpt-index.readthedocs.io/en/latest/use_cases/queries.html#compare-contrast-queries" rel="noopener ugc nofollow" target="_blank">explicitly provide compare/contrast capabilities</a> over any subset of documents. The tool itself can contain “agent-like” decision-making capabilities under the hood. LlamaIndex provides a variety of modules around <a href="https://gpt-index.readthedocs.io/en/latest/examples/query_engine/RouterQueryEngine.html" rel="noopener ugc nofollow" target="_blank">routing</a>, <a href="https://gpt-index.readthedocs.io/en/latest/how_to/query/query_transformations.html#single-step-query-decomposition" rel="noopener ugc nofollow" target="_blank">query decomposition</a>, and <a href="https://gpt-index.readthedocs.io/en/latest/examples/query_engine/sub_question_query_engine.html" rel="noopener ugc nofollow" target="_blank">multi-part query planning</a>.</p><p>In this blog post, we are interested in comparing the following approaches to designing agents and tools to see which approach can provide good answers to different user queries in a robust fashion:</p><ul><li>more <em class="ow">complex and unconstrained </em>agent interaction (ReAct) over a set of <em class="ow">simple </em>Tools</li><li>more <em class="ow">simple and constrained </em>agent interaction (simple routing) that uses more <em class="ow">complex </em>Tools</li></ul><figure><figcaption class="qp fe qq qb qc qr qs be b bf z dt">Complex Agents with Simple Tools, Simple Agents with Complex Tools</figcaption><img src="/blog/images/1*R4zNJYl_k47ZvAbapWe70Q.png" alt="" width="700" height="307"></figure><p>Essentially what we are interested in is how much complexity can be pushed to the agent interaction layer vs. being left in the Tool layer. We explore the following concrete example: let’s say the user query is to compare/contrast two different documents (a relatively complex query). If the set of Tools are all just vector indices over different documents, could the agent interaction loop figure out how to execute that query reliably against the vector indices? On the other hand, if we push the complexity down to the Tool layer, then we could <em class="ow">explicitly </em>have a Tool that can perform “compare/contrast” over your Documents. Then the burden on the agent is to simply call this Tool instead of interacting with a set of other tools in a more complex fashion.</p><h2>High-Level Findings</h2><p>The high-level finding is that <strong>less sophisticated agents need more constraints. </strong>More specifically, we found that using a GPT-3 powered agent in a ReAct loop did not provide good results over complex queries; it was not able to figure out the proper interaction pattern over the provided set of Tools in order to surface the results. Instead, by adding more constraints to the agent behavior and providing more sophistication in the Tool itself, we were able to get a GPT-3 agent to produce better results.</p><p><strong>Smarter agents require fewer constraints. </strong>We did find that GPT-4 agents with ReAct were able to provide better query results than GPT-3 agents when presented with a set of simple Tools over the data. This implies that more powerful agents may not need as many tools to “explicitly” perform tasks when much of that logic can be handled in the agent interaction loop.</p><h1>Setup</h1><p>Our data consists of three Uber 10-Q filings (quarterly financial reports) in 2022: March, June, and September. We wish to execute different queries over this data; the bulk of these queries are around comparing different bits of information between these documents.</p><pre><span id="78ce" class="qx nb gt qu b bf qy qz l ra rb">march_2022 = SimpleDirectoryReader(input_files=["../data/10q/uber_10q_march_2022.pdf"]).load_data()
june_2022 = SimpleDirectoryReader(input_files=["../data/10q/uber_10q_june_2022.pdf"]).load_data()
sept_2022 = SimpleDirectoryReader(input_files=["../data/10q/uber_10q_sept_2022.pdf"]).load_data()</span></pre><p>We use LlamaIndex to define a vector index over each document, which just stores the document chunks + embeddings in a vector store. We can then query each vector index using a simple<code class="cw rc rd re qu b">QueryEngine</code> . We create a tool for each of these<code class="cw rc rd re qu b">QueryEngine</code> objects.</p><pre><span id="7ecb" class="qx nb gt qu b bf qy qz l ra rb"># define indices
march_index = GPTVectorStoreIndex.from_documents(march_2022)
june_index = GPTVectorStoreIndex.from_documents(june_2022)
sept_index = GPTVectorStoreIndex.from_documents(sept_2022)

# define query engine
march_engine = march_index.as_query_engine(similarity_top_k=3)
june_engine = june_index.as_query_engine(similarity_top_k=3)
sept_engine = sept_index.as_query_engine(similarity_top_k=3)</span></pre><p>We also define a <code class="cw rc rd re qu b">ComposableGraph</code> over these three documents. The composable graph roughly follows the <a href="https://gpt-index.readthedocs.io/en/latest/use_cases/queries.html#compare-contrast-queries" rel="noopener ugc nofollow" target="_blank">guide described here</a>. This graph is explicitly setup to perform compare/contrast queries over these three documents.</p><pre><span id="a152" class="qx nb gt qu b bf qy qz l ra rb">graph = ComposableGraph.from_indices(
    GPTListIndex,
    children_indices=[march_index, june_index, sept_index],
    index_summaries=[
        "Provides information about Uber quarterly financials ending March 2022",
        "Provides information about Uber quarterly financials ending June 2022",
        "Provides information about Uber quarterly financials ending September 2022"
    ]
)</span></pre><p>The graph can be queried with a <code class="cw rc rd re qu b">ComposableGraphQueryEngine</code> :</p><pre><span id="9190" class="qx nb gt qu b bf qy qz l ra rb"><span class="hljs-comment"># define decompose_transform</span>
decompose_transform = DecomposeQueryTransform(verbose=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># define custom query engines</span>
custom_query_engines = {}
<span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> [march_index, june_index, sept_index]:
    query_engine = index.as_query_engine(service_context=service_context)
    query_engine = TransformQueryEngine(
        query_engine,
        query_transform=decompose_transform,
        transform_extra_info={<span class="hljs-string">'index_summary'</span>: index.index_struct.summary},
    )
    custom_query_engines[index.index_id] = query_engine

custom_query_engines[graph.root_id] = graph.root_index.as_query_engine(
    service_context=service_context,
    streaming=<span class="hljs-literal">True</span>,
)

<span class="hljs-comment"># define graph</span>
g_engine = graph.as_query_engine(
    custom_query_engines=custom_query_engines
)</span></pre><p>We try the following agent setups:</p><ul><li><strong>GPT-3 ReAct agent: </strong>A zero-shot GPT-3 ReAct agent with three Tools: each Tool corresponds to the vector index over a 10-Q filing.</li><li><strong>GPT-4 ReAct agent: </strong>Same as above but using GPT-4 instead.</li><li><strong>Simple Router agent: </strong>A simple router “agent” with four Tools: the three Tools listed above + the <code class="cw rc rd re qu b">ComposableGraphQueryEngine</code> explicitly setup to perform compare/contrast queries.</li></ul><p>The code snippets for initializing these agents are below. For the simple router agent, we use the native <code class="cw rc rd re qu b">RouterQueryEngine</code> within LlamaIndex, though you should also be able to achieve similar results in LangChain through either the zero-shot agent (with tweaked settings) or the router chain.</p><h2><strong>GPT-3/GPT-4 ReAct Agent Setup</strong></h2><pre><span id="4d83" class="qx nb gt qu b bf qy qz l ra rb"><span class="hljs-comment"># initializing zero-shot ReAct agent</span>

uber_config_sept = IndexToolConfig(
    query_engine=sept_engine, 
    name=<span class="hljs-string">f"Uber 10Q September 2022"</span>,
    description=<span class="hljs-string">f"Provides information about Uber quarterly financials ending September 2022"</span>,
    tool_kwargs={<span class="hljs-string">"return_direct"</span>: <span class="hljs-literal">False</span>}
)
uber_config_june = IndexToolConfig(
    query_engine=june_engine, 
    name=<span class="hljs-string">f"Uber 10Q June 2022"</span>,
    description=<span class="hljs-string">f"Provides information about Uber quarterly financials ending June 2022"</span>,
    tool_kwargs={<span class="hljs-string">"return_direct"</span>: <span class="hljs-literal">False</span>}
)
uber_config_march = IndexToolConfig(
    query_engine=march_engine, 
    name=<span class="hljs-string">f"Uber 10Q March 2022"</span>,
    description=<span class="hljs-string">f"Provides information about Uber quarterly financials ending March 2022"</span>,
    tool_kwargs={<span class="hljs-string">"return_direct"</span>: <span class="hljs-literal">False</span>}
)

toolkit = LlamaToolkit(
    index_configs=[uber_config_sept, uber_config_june, uber_config_march],
)

<span class="hljs-comment"># this is a light wrapper around `initialize_agent` in langchain (which defaults to zero-shot)</span>
agent_chain = create_llama_agent(
    toolkit,
    llm, <span class="hljs-comment"># can be GPT-3 or GPT-4 </span>
    verbose=<span class="hljs-literal">True</span>
)</span></pre><h2>Simple Router Agent Setup</h2><pre><span id="15e1" class="qx nb gt qu b bf qy qz l ra rb">
query_tool_sept = QueryEngineTool.from_defaults(
    query_engine=sept_engine,
    description=f"Provides information about Uber quarterly financials ending September 2022",
)
query_tool_june = QueryEngineTool.from_defaults(
    query_engine=june_engine,
    description=f"Provides information about Uber quarterly financials ending June 2022",
)
query_tool_march = QueryEngineTool.from_defaults(
    query_engine=march_engine,
    description=f"Provides information about Uber quarterly financials ending March 2022",
)
query_tool_graph = QueryEngineTool.from_defaults(
    query_engine=g_engine,
    description=f"Provides comparisons between Uber financials across quarters in 2022. Can be used to answer "
                 "any questions that require analysis across multiple quarters.",
)

# our "router" query engine is effectively a simple agent that can only perform routing
query_engine = RouterQueryEngine(
    selector=LLMSingleSelector.from_defaults(),
    query_engine_tools=[
        query_tool_sept,
        query_tool_june,
        query_tool_march,
        query_tool_graph
    ]
)</span></pre><p>Now that we’ve described the setup, let’s take a look at the results below!</p><h1>Findings and Experiments</h1><p>At a high-level, we find using GPT-3 in ReAct agents produces suboptimal results over these queries. They tend to exhibit the following characteristics:</p><ul><li><strong>Unpredictability in the set of chosen tools: </strong>The set of tools chosen can differ even if the questions are semantically similar, leading to variability in the responses.</li><li><strong>Lack of coverage in the set of chosen tools: </strong>Oftentimes we expect that a given question is able to make use of all three 10-Q statements, but only a subset of them are picked.</li><li><strong>Erroneous chain-of-thought processing: </strong>Sometimes the agent uses tools throughout the CoT process that are irrelevant to the question.</li></ul><p>In contrast, we find that GPT-4 ReAct agents provide answers that are more relevant, predictable, and exhibit fewer errors in intermediate results.</p><p>Finally, we find that using a simpler routing-only GPT-3 agent with access to an explicit “compare/contrast” tool allows the agent to perform better.</p><p>As a reminder, full results are in the notebook: <a href="https://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing</a></p><h2>GPT-3 ReAct Agent Results</h2><p><strong>Query 1</strong></p><pre><span id="19d6" class="qx nb gt qu b bf qy qz l ra rb">agent_chain.run(input="Analyze Uber revenue growth over the last few quarters")</span></pre><p>Response:</p><figure><img src="/blog/images/1*Rwh0f3D-D-KhpiG3hAoSkw.png" alt="" width="700" height="263"></figure><p>We see that only the September 10-Q filing is chosen to answer the question. The September 10-Q does contain some information about revenue growth compared to the same period in 2021, but that doesn’t explicitly answer the question, which is about revenue growth the past few quarters.</p><p><strong>Query 2</strong></p><pre><span id="8ad0" class="qx nb gt qu b bf qy qz l ra rb">agent_chain.run(input="Analyze changes in risk factors for Uber")</span></pre><p>Response:</p><figure><img src="/blog/images/1*R7zJfetsc8mXhG4kW8_Siw.png" alt="" width="700" height="491"></figure><p>The September and June 10-Q filings are chosen, but not March. Moreover, the answer is vague and doesn’t provide much detail regarding concrete risk factors for Uber (and also mentions that the risk factors “have changed over the past three quarters” even though it’s only using two Tools).</p><p><strong>Query 3</strong></p><p>In this query, we more explicitly showcase how slight changes in prompts can induce different chain-of-thought paths through different Tools, and as a result produce different answers.</p><pre><span id="0f43" class="qx nb gt qu b bf qy qz l ra rb"># Prompt variation 1 
agent_chain.run(input="Analyze Uber revenue growth and risk factors over time")</span></pre><p>Response:</p><figure><img src="/blog/images/1*AbOFy6vaAQ3vijwhV5V1ug.png" alt="" width="700" height="426"></figure><pre><span id="7806" class="qx nb gt qu b bf qy qz l ra rb"># Prompt variation 2
agent_chain.run(input="Analyze Uber revenue growth and risk factors over quarters")</span></pre><figure><img src="/blog/images/1*LgCbvrqwEGROw_vma0l4QA.png" alt="" width="700" height="484"></figure><p>The main difference between these two queries is “over time” versus “over quarters.” As we can see, not only are the selected Tools different between the two variations, but the inputs are different as well — in the first it’s “financials”, and in the second it’s “Revenue growth and risk factors.”</p><p>Since the Tool input in the first variant is unrelated to the question, the answer is similarly vague: “Uber’s revenue growth and risk factors can be analyzed by comparing the financials…”</p><p><strong>Query 4:</strong></p><p>Here instead of asking a compare/contrast question let’s just ask a question about a given statement.</p><pre><span id="603f" class="qx nb gt qu b bf qy qz l ra rb">agent_chain.run(input="How much cash did Uber have in sept 2022?")</span></pre><figure><img src="/blog/images/1*A7bhWOv5Z3HdTp2iafR3sA.png" alt="" width="700" height="331"></figure><p>We see that the agent makes two errors 1) it is not able to supply an action input to each Tool, and 2) ends up looking through the June and March filings which are irrelevant to the question.</p><h2>GPT-4 ReAct Agent Results</h2><p>GPT-4 ReAct agents perform a lot better than GPT-3 agents. They comprehensively go through the set of available Tools, and provide much more detailed observation extraction and response synthesis.</p><p>We won’t go through all of these examples, but they can be found in the example notebook!</p><p><strong>Query 1:</strong></p><pre><span id="24a6" class="qx nb gt qu b bf qy qz l ra rb">agent_chain_gpt4.run(input="Analyze Uber revenue growth over the last few quarters")</span></pre><p>Response:</p><figure><img src="/blog/images/1*PJDOtqVHKJ9I_l6rICp6dQ.png" alt="" width="700" height="232"></figure><p>Unlike the GPT-3 agent, here the GPT-4 agent at least goes through every filing and synthesizes the result.</p><p><strong>Query 2</strong></p><pre><span id="4716" class="qx nb gt qu b bf qy qz l ra rb">agent_chain_gpt4.run(input="Analyze changes in risk factors for Uber")</span></pre><p>Response:</p><figure><img src="/blog/images/1*VBPGlCvcyjaRYEpXChGm2w.png" alt="" width="700" height="465"></figure><p>Here the GPT-4 agent still only looks at September and June (and skips March), but the response is way more detailed, and references concrete facts within the report.</p><h2>GPT-3 Router Agent Results</h2><p>Reminder: the router agent doesn’t do any CoT and has additional access to our ComposableGraph query engine, which can explicitly perform compare/contrast queries. Let’s take a look at how this agent does.</p><p><strong>Query 1</strong></p><pre><span id="2e7e" class="qx nb gt qu b bf qy qz l ra rb">response = query_engine.query("Analyze Uber revenue growth over the last few quarters")</span></pre><p>Response (intermediate steps):</p><pre><span id="9a3e" class="qx nb gt qu b bf qy qz l ra rb">Selecting query engine 3: Provides comparisons between Uber financials across quarters in 2022. Can be used to answer any questions that require analysis across multiple quarters..
&gt; Current query: Analyze Uber revenue growth over the last few quarters
&gt; New query:  What was Uber's revenue growth from the last quarter ending March 2022 compared to the previous quarter?
&gt; Current query: Analyze Uber revenue growth over the last few quarters
&gt; New query:  What was Uber's revenue growth from the last quarter ending June 2022 compared to the previous quarter?
&gt; Current query: Analyze Uber revenue growth over the last few quarters
&gt; New query:  What was Uber's revenue growth from the last few quarters ending September 2022?
</span></pre><p>Final Response</p><pre><span id="66e2" class="qx nb gt qu b bf qy qz l ra rb">Based on the limited context information provided, we can only analyze Uber's revenue growth for two specific quarters:

1. For the quarter ending March 2022, Uber's revenue growth increased compared to the first quarter of 2021. However, the exact percentage of growth is not provided.

2. For the quarter ending September 2022, Uber's revenue growth was 72%.

Unfortunately, we do not have enough data to analyze the revenue growth for the quarters ending June 2022 or to compare it to the previous quarter. To provide a more comprehensive analysis, additional data on Uber's revenue growth for other quarters would be needed.</span></pre><p>To be fair, this response does not cover the month of June. But the fault of that lies with the implementation of the Tool itself rather than the agent interaction step. The agent’s only job is to pick the right Tool to solve the task at hand, and it does that job correctly; it decides to choose the Tool corresponding to our <code class="cw rc rd re qu b">ComposableGraphQueryEngine</code> abstraction (which can perform compare/contrast queries).</p><p><strong>Query 2</strong></p><pre><span id="e2bd" class="qx nb gt qu b bf qy qz l ra rb">response = query_engine.query("Analyze changes in risk factors for Uber")</span></pre><p>Response (intermediate steps):</p><pre><span id="58e3" class="qx nb gt qu b bf qy qz l ra rb"><span class="hljs-variable constant_">INFO</span><span class="hljs-symbol">:llama_index</span>.query_engine.<span class="hljs-symbol">router_query_engine:</span><span class="hljs-title class_">Selecting</span> query engine <span class="hljs-number">3</span>: <span class="hljs-title class_">Provides</span> comparisons between <span class="hljs-title class_">Uber</span> financials across quarters <span class="hljs-keyword">in</span> <span class="hljs-number">2022</span>. <span class="hljs-title class_">Can</span> be used to answer any questions that <span class="hljs-keyword">require</span> analysis across multiple quarters..
<span class="hljs-title class_">Selecting</span> query engine <span class="hljs-number">3</span>: <span class="hljs-title class_">Provides</span> comparisons between <span class="hljs-title class_">Uber</span> financials across quarters <span class="hljs-keyword">in</span> <span class="hljs-number">2022</span>. <span class="hljs-title class_">Can</span> be used to answer any questions that <span class="hljs-keyword">require</span> analysis across multiple quarters..
&amp;gt; <span class="hljs-title class_">Current</span> <span class="hljs-symbol">query:</span> <span class="hljs-title class_">Analyze</span> changes <span class="hljs-keyword">in</span> risk factors <span class="hljs-keyword">for</span> <span class="hljs-title class_">Uber</span>
&amp;gt; <span class="hljs-title class_">New</span> <span class="hljs-symbol">query:</span>  <span class="hljs-title class_">What</span> are the risk factors <span class="hljs-keyword">for</span> <span class="hljs-title class_">Uber</span> <span class="hljs-keyword">in</span> the quarter ending <span class="hljs-title class_">March</span> <span class="hljs-number">2022</span>?
&amp;gt; <span class="hljs-title class_">Current</span> <span class="hljs-symbol">query:</span> <span class="hljs-title class_">Analyze</span> changes <span class="hljs-keyword">in</span> risk factors <span class="hljs-keyword">for</span> <span class="hljs-title class_">Uber</span>
&amp;gt; <span class="hljs-title class_">New</span> <span class="hljs-symbol">query:</span>  <span class="hljs-title class_">What</span> are the risk factors <span class="hljs-keyword">for</span> <span class="hljs-title class_">Uber</span> <span class="hljs-keyword">in</span> the quarter ending <span class="hljs-title class_">June</span> <span class="hljs-number">2022</span>?
&amp;gt; <span class="hljs-title class_">Current</span> <span class="hljs-symbol">query:</span> <span class="hljs-title class_">Analyze</span> changes <span class="hljs-keyword">in</span> risk factors <span class="hljs-keyword">for</span> <span class="hljs-title class_">Uber</span>
&amp;gt; <span class="hljs-title class_">New</span> <span class="hljs-symbol">query:</span>  <span class="hljs-title class_">What</span> are the risk factors <span class="hljs-keyword">for</span> <span class="hljs-title class_">Uber</span> <span class="hljs-keyword">in</span> the quarter ending <span class="hljs-title class_">September</span> <span class="hljs-number">2022</span>?</span></pre><p>Final Response</p><pre><span id="65a0" class="qx nb gt qu b bf qy qz l ra rb">From the context information provided, we can analyze the changes in risk factors <span class="hljs-keyword">for</span> Uber across the three quarters as follows:

<span class="hljs-number">1.</span> COVID<span class="hljs-number">-19</span> pandemic: The ongoing pandemic remains a constant risk factor across all quarters, with its impact on driver <span class="hljs-keyword">and</span> courier supply constraints, consumer demand, <span class="hljs-keyword">and</span> government restrictions. However, the specific concerns related to the pandemic may evolve, such as the emergence of <span class="hljs-keyword">new</span> virus variants <span class="hljs-keyword">or</span> changes in vaccination rates.

<span class="hljs-number">2.</span> Driver <span class="hljs-keyword">and</span> courier supply constraints: This risk factor is present in the quarter ending March <span class="hljs-number">2022</span> but is <span class="hljs-keyword">not</span> explicitly mentioned in the subsequent quarters. However, it may still be an underlying concern, especially <span class="hljs-keyword">if</span> the pandemic continues to impact driver availability.

<span class="hljs-number">3.</span> Changes in consumer demand: This risk factor is mentioned in the quarter ending March <span class="hljs-number">2022</span>, with an imbalance between Mobility <span class="hljs-keyword">and</span> Delivery services. It is <span class="hljs-keyword">not</span> explicitly mentioned in the subsequent quarters, but fluctuations in revenue due to changes in Gross Bookings <span class="hljs-keyword">and</span> Mobility Trip volumes in the quarter ending June <span class="hljs-number">2022</span> could be related to changes in consumer demand.

<span class="hljs-number">4.</span> Government restrictions <span class="hljs-keyword">and</span> regulations: This risk factor is present in the quarter ending March <span class="hljs-number">2022</span>, with the impact of restrictions on Mobility offerings. In the quarter ending June <span class="hljs-number">2022</span>, the focus shifts to the potential impact of regulatory changes <span class="hljs-keyword">and</span> legal claims, such as driver classification in the UK. In the quarter ending September <span class="hljs-number">2022</span>, the risk factor of driver classification as employees, workers, <span class="hljs-keyword">or</span> quasi-employees becomes more prominent.

<span class="hljs-number">5.</span> Uncertainty around future developments: This risk factor is mentioned in the quarter ending March <span class="hljs-number">2022</span> but is <span class="hljs-keyword">not</span> explicitly mentioned in the subsequent quarters. However, it may still be an underlying concern, especially with the ongoing impact of COVID<span class="hljs-number">-19</span> <span class="hljs-keyword">and</span> potential permanent changes to end-users<span class="hljs-number">'</span> behavior.

<span class="hljs-number">6.</span> Accounting pronouncements: This risk factor is introduced in the quarter ending June <span class="hljs-number">2022</span>, with the adoption <span class="hljs-keyword">and</span> impact of recently issued accounting pronouncements potentially affecting Uber<span class="hljs-number">'</span>s consolidated financial statements.

<span class="hljs-number">7.</span> Integration <span class="hljs-keyword">and</span> performance of acquired businesses: This risk factor is introduced in the quarter ending June <span class="hljs-number">2022</span>, with the acquisition of Transplace contributing to the increase in Freight revenue.

<span class="hljs-number">8.</span> Competition: This risk factor is introduced in the quarter ending September <span class="hljs-number">2022</span>, highlighting the highly competitive nature of the mobility, delivery, <span class="hljs-keyword">and</span> logistics industries, <span class="hljs-keyword">and</span> the need to lower fares, offer incentives, <span class="hljs-keyword">and</span> promotions to remain competitive.

<span class="hljs-number">9.</span> Significant losses <span class="hljs-keyword">and</span> increasing operating expenses: This risk factor is introduced in the quarter ending September <span class="hljs-number">2022</span>, emphasizing the financial challenges Uber faces in achieving profitability.</span></pre><p>The job of the agent is once again simple: it chooses the graph query engine that is optimized to perform “compare/contrast” queries. The result is much more detailed than the result obtained from the GPT-3 ReAct agent (and is comparable to the GPT-4 ReAct agent). It contains a detailed analysis of all risk factors in bullet points, and offers a comparison across time for all bullet points.</p><p><strong>Query 3</strong></p><pre><span id="ef96" class="qx nb gt qu b bf qy qz l ra rb">response = query_engine.query("Analyze Uber revenue growth and risk factors over the last few quarters")</span></pre><p>Response (intermediate steps):</p><pre><span id="8dab" class="qx nb gt qu b bf qy qz l ra rb">&gt; Current query: Analyze Uber revenue growth and risk factors over quarters
&gt; New query:  What is Uber's revenue growth and risk factors for the quarter ending March 2022?
&gt; Current query: Analyze Uber revenue growth and risk factors over quarters
&gt; New query:  What is Uber's revenue growth and risk factors for the quarter ending March 2022?
&gt; Current query: Analyze Uber revenue growth and risk factors over quarters
&gt; New query:  What is Uber's revenue growth and risk factors for the quarter ending June 2022?
&gt; Current query: Analyze Uber revenue growth and risk factors over quarters
&gt; New query:  What is Uber's revenue growth and risk factors for the quarter ending June 2022?
&gt; Current query: Analyze Uber revenue growth and risk factors over quarters
&gt; New query:  What were Uber's total revenues for the quarter ending September 2022?
&gt; Current query: Analyze Uber revenue growth and risk factors over quarters
&gt; New query:  What were Uber's total revenues for the quarter ending September 2022?</span></pre><p>Final Response</p><pre><span id="c81b" class="qx nb gt qu b bf qy qz l ra rb">Uber<span class="hljs-string">'s revenue growth has been impressive over the past few quarters, with the quarter ending March 2022 showing a 136% year-over-year growth and the quarter ending June 2022 showing a 105% year-over-year growth. The revenue for the quarter ending June 2022 was $8,343 million. 

The risk factors for Uber'</span>s business have been largely related to the ongoing impacts of the COVID-<span class="hljs-number">19</span> pandemic, including reduced <span class="hljs-keyword">global</span> demand <span class="hljs-keyword">for</span> Mobility rides, supply constraints, <span class="hljs-keyword">and</span> potential permanent changes to end-user behavior. These risk factors have been present in both the quarter ending March <span class="hljs-number">2022</span> <span class="hljs-keyword">and</span> the quarter ending June <span class="hljs-number">2022</span>, though the specific risks have varied slightly.</span></pre><h1>Concluding Thoughts</h1><p>ReAct-based agents offer a powerful, general reasoning loop, and have the potential to solve complex tasks over your data. But they tend to only work reliably with more powerful language models such as GPT-4. Less sophisticated models (e.g. GPT-3) will make more unpredictable and erroneous decisions, leading to subpar query performance over your data sources.</p><p>Agents implemented with “dumber” models need more interaction constraints in order to make more reliable, less erroneous decisions. We find that if we explicitly constrain the agent interface and push the complexity down to the Tool layer, we can still create agents that offer good performance over your data.</p><p>Of course, this is just an initial analysis and there’s a few caveats/limitations:</p><ul><li>You may be able to “prompt hack” the default ReAct loop to get more consistent results, and we did not try that.</li><li>We only tested this over a set of three financial documents. There’s a lot more work that needs to be done if we want to test this out on thousands of docs.</li><li>We only compared GPT-3 and GPT-4, there’s so many more models to compare/benchmark, e.g ChatGPT, any open-source model, Anthropic Claude, etc.</li><li>We did not test out other agent interaction patterns besides ReAct: “plan and solve” agents (though we do have similar formulations in LlamaIndex), AutoGPT-like task management, and more.</li></ul><p>Whether you’ve run into similar findings or you disagree with our analysis, let us know! We’d love to facilitate this discussion on our <a href="https://discord.gg/dGcwcsnxhU" rel="noopener ugc nofollow" target="_blank">Discord</a>.</p><h2>Notebook Walkthrough</h2><p>You can find the full notebook walkthrough here: <a href="https://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing</a></p></div><div class="BlogPost_relatedPosts__0z6SN"><h2 class="Text_text__zPO0D Text_text-align-center__HhKqo Text_text-size-16__PkjFu Text_text-weight-400__5ENkK Text_text-family-spaceGrotesk__E4zcE BlogPost_relatedPostsTitle___JIrW">Related articles</h2><ul class="BlogPost_relatedPostsList__uOKzB"><li><div class="CardBlog_card__mm0Zw"><div class="CardBlog_thumbnail__XCu_R"><img alt="" loading="lazy" width="400" height="280" decoding="async" data-nimg="1" class="CardBlog_image__I2Asd" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2Fa195d5cbe68a6c2cb0847c985ead93111909f0bf-3378x3265.webp%3Ffit%3Dmax%26auto%3Dformat&amp;w=640&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2Fa195d5cbe68a6c2cb0847c985ead93111909f0bf-3378x3265.webp%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2Fa195d5cbe68a6c2cb0847c985ead93111909f0bf-3378x3265.webp%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75"/></div><p class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth CardBlog_title__qC51U"><a href="/blog/querying-a-network-of-knowledge-with-llama-index-networks-d784b4c3006f">Querying a network of knowledge with llama-index-networks</a></p><p class="Text_text__zPO0D Text_text-size-16__PkjFu">2024-02-27</p></div></li><li><div class="CardBlog_card__mm0Zw"><div class="CardBlog_thumbnail__XCu_R"><img alt="" loading="lazy" width="400" height="280" decoding="async" data-nimg="1" class="CardBlog_image__I2Asd" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F4ae00650dab860c90f1a8f797b33c1026438ba2f-1024x1024.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=640&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F4ae00650dab860c90f1a8f797b33c1026438ba2f-1024x1024.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F4ae00650dab860c90f1a8f797b33c1026438ba2f-1024x1024.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75"/></div><p class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth CardBlog_title__qC51U"><a href="/blog/multimodal-rag-for-advanced-video-processing-with-llamaindex-lancedb-33be4804822e">MultiModal RAG for Advanced Video Processing with LlamaIndex &amp; LanceDB</a></p><p class="Text_text__zPO0D Text_text-size-16__PkjFu">2024-02-17</p></div></li><li><div class="CardBlog_card__mm0Zw"><div class="CardBlog_thumbnail__XCu_R"><img alt="" loading="lazy" width="400" height="280" decoding="async" data-nimg="1" class="CardBlog_image__I2Asd" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F0e45151b7b56fda591f51cebb87cbfc436bcb697-1024x1024.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=640&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F0e45151b7b56fda591f51cebb87cbfc436bcb697-1024x1024.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F0e45151b7b56fda591f51cebb87cbfc436bcb697-1024x1024.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75"/></div><p class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth CardBlog_title__qC51U"><a href="/blog/how-to-build-llm-agents-in-typescript-with-llamaindex-ts-a88ed364a7aa">How to build LLM Agents in TypeScript with LlamaIndex.TS</a></p><p class="Text_text__zPO0D Text_text-size-16__PkjFu">2024-02-08</p></div></li><li><div class="CardBlog_card__mm0Zw"><div class="CardBlog_thumbnail__XCu_R"><img alt="" loading="lazy" width="400" height="280" decoding="async" data-nimg="1" class="CardBlog_image__I2Asd" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F8890c5098dbde95bd57d8c230fb46ee60bede234-2400x1420.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=640&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F8890c5098dbde95bd57d8c230fb46ee60bede234-2400x1420.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fcdn.sanity.io%2Fimages%2F7m9jw85w%2Fproduction%2F8890c5098dbde95bd57d8c230fb46ee60bede234-2400x1420.png%3Ffit%3Dmax%26auto%3Dformat&amp;w=828&amp;q=75"/></div><p class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth CardBlog_title__qC51U"><a href="/blog/agentic-rag-with-llamaindex-2721b8a49ff6">Agentic RAG With LlamaIndex</a></p><p class="Text_text__zPO0D Text_text-size-16__PkjFu">2024-01-30</p></div></li></ul></div></section></main><footer class="Footer_footer__eNA9m"><div class="Footer_navContainer__7bvx4"><div class="Footer_logoContainer__3EpzI"><img alt="LlamaIndex" loading="lazy" width="213" height="42" decoding="async" data-nimg="1" style="color:transparent" src="/llamaindex.svg"/><div class="Footer_socialContainer__GdOgk"><ul class="Socials_socials__8Y_s5"><li><a href="https://github.com/run-llama/llama_index"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li><a href="https://discord.com/invite/eN6D2HQ4aX"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 640 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"></path></svg></a></li><li><a href="https://twitter.com/llama_index"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></a></li><li><a href="https://www.linkedin.com/company/91154103/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li><a href="https://www.youtube.com/@LlamaIndex"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li></ul></div></div><div class="Footer_nav__BLEuE"><div><h3 class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth Footer_navHeader__9o83e"><a href="/">LlamaIndex</a></h3><ul><li><a href="/blog"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Blog</span></a></li><li><a href="/partners"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Partners</span></a></li><li><a href="/careers"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Careers</span></a></li><li><a href="/contact"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Contact</span></a></li><li><a href="/brand"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Brand</span></a></li><li><a href="https://llamaindex.statuspage.io" target="_blank"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Status</span></a></li><li><a href="https://app.vanta.com/runllama.ai/trust/pkcgbjf8b3ihxjpqdx17nu" target="_blank"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Trust Center</span></a></li></ul></div><div><h3 class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth Footer_navHeader__9o83e"><a href="/enterprise">Enterprise</a></h3><ul><li><a href="https://cloud.llamaindex.ai" data-tracking-variant="link" data-tracking-section="footer"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">LlamaCloud</span></a></li><li><a href="https://cloud.llamaindex.ai/parse" data-tracking-variant="link" data-tracking-section="footer"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">LlamaParse</span></a></li><li><a href="/customers"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Customers</span></a></li><li><a href="/llamacloud-sharepoint-data-loading-for-generative-ai" data-tracking-variant="link" data-tracking-section="footer"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">SharePoint</span></a></li><li><a href="/llamacloud-aws-s3-data-loading-for-generative-ai" data-tracking-variant="link" data-tracking-section="footer"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">AWS S3</span></a></li><li><a href="/llamacloud-azure-blob-storage-data-loading-for-generative-ai" data-tracking-variant="link" data-tracking-section="footer"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Azure Blob Storage</span></a></li><li><a href="/llamacloud-google-drive-data-loading-for-generative-ai" data-tracking-variant="link" data-tracking-section="footer"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Google Drive</span></a></li> </ul></div><div><h3 class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth Footer_navHeader__9o83e"><a href="/framework">Framework</a></h3><ul><li><a href="https://pypi.org/project/llama-index/"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Python package</span></a></li><li><a href="https://docs.llamaindex.ai"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Python docs</span></a></li><li><a href="https://www.npmjs.com/package/llamaindex"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">TypeScript package</span></a></li><li><a href="https://ts.llamaindex.ai"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">TypeScript docs</span></a></li><li><a href="https://llamahub.ai"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">LlamaHub</span></a></li><li><a href="https://github.com/run-llama"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">GitHub</span></a></li></ul></div><div><h3 class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth Footer_navHeader__9o83e"><a href="/community">Community</a></h3><ul><li><a href="/community#newsletter"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Newsletter</span></a></li><li><a href="https://discord.com/invite/eN6D2HQ4aX"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Discord</span></a></li><li><a href="https://www.linkedin.com/company/91154103/"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">LinkedIn</span></a></li><li><a href="https://twitter.com/llama_index"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">Twitter/X</span></a></li><li><a href="https://www.youtube.com/@LlamaIndex"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">YouTube</span></a></li><li><a href="https://bsky.app/profile/llamaindex.bsky.social"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">BlueSky</span></a></li></ul></div><div><h3 class="Text_text__zPO0D Text_text-size-20__LNa6Q Text_text-weight-600__fKYth Footer_navHeader__9o83e">Starter projects</h3><ul><li><a href="https://www.npmjs.com/package/create-llama"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">create-llama</span></a></li><li><a href="https://secinsights.ai"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">SEC Insights</span></a></li><li><a href="https://github.com/run-llama/llamabot"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">LlamaBot</span></a></li><li><a href="https://docs.llamaindex.ai/en/stable/use_cases/q_and_a/rag_cli.html"><span class="Text_text__zPO0D Text_text-size-16__PkjFu">RAG CLI</span></a></li></ul></div></div></div><div class="Footer_copyrightContainer__mBKsT"><p class="Text_text__zPO0D Text_text-size-14__6Qc26 Footer_copyright__vFlrA">© <!-- -->2025<!-- --> LlamaIndex</p><div class="Footer_legalNav__O1yJA"><p class="Text_text__zPO0D Text_text-size-14__6Qc26 Footer_copyright__vFlrA"><a href="/files/privacy-notice.pdf">Privacy Notice</a></p><p class="Text_text__zPO0D Text_text-size-14__6Qc26 Footer_copyright__vFlrA"><a href="/files/terms-of-service.pdf">Terms of Service</a></p><p class="Text_text__zPO0D Text_text-size-14__6Qc26 Footer_copyright__vFlrA"><a href="https://bit.ly/llamaindexdpa">Data Processing Addendum</a></p></div></div></footer></div><svg xmlns="http://www.w3.org/2000/svg" class="flt_svg" style="display:none"><defs><filter id="flt_tag"><feGaussianBlur in="SourceGraphic" result="blur" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blur" result="flt_tag" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 19 -9"></feColorMatrix><feComposite in="SourceGraphic" in2="flt_tag" operator="atop"></feComposite></filter><filter id="svg_blur_large"><feGaussianBlur in="SourceGraphic" result="blur" stdDeviation="8"></feGaussianBlur><feColorMatrix in="blur" result="svg_blur_large" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 19 -9"></feColorMatrix><feComposite in="SourceGraphic" in2="svg_blur_large" operator="atop"></feComposite></filter></defs></svg></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"page":{"announcement":{"_createdAt":"2024-12-15T02:26:13Z","_id":"announcement","_rev":"bDjEm7gsnDBrRrmjaaG2yK","_type":"announcement","_updatedAt":"2025-05-19T19:20:19Z","title":"Meet LlamaIndex at the Databricks Data + AI Summit!","url":"http://48755185.hs-sites.com/llamaindex-0"},"post":{"_createdAt":"2024-02-22T21:48:20Z","_id":"d65d605b-dbb9-4acc-8ae1-744a28a65143","_rev":"TLgH6AcXrxoqw75SBDhn1n","_type":"blogPost","_updatedAt":"2025-05-21T20:40:01Z","announcement":[{"_createdAt":"2024-12-15T02:26:13Z","_id":"announcement","_rev":"bDjEm7gsnDBrRrmjaaG2yK","_type":"announcement","_updatedAt":"2025-05-19T19:20:19Z","title":"Meet LlamaIndex at the Databricks Data + AI Summit!","url":"http://48755185.hs-sites.com/llamaindex-0"}],"authors":[{"_createdAt":"2024-02-22T19:59:39Z","_id":"26898661-ce74-4e56-a3bb-21000059ea8d","_rev":"1yZmiycp7gyBYGbmM40Ock","_type":"people","_updatedAt":"2025-05-07T15:41:41Z","image":{"_type":"image","asset":{"_ref":"image-e4426ff6862cbb8bec81b8407730e6e1e9383c8f-2176x2176-jpg","_type":"reference"}},"name":"Jerry Liu","position":"CEO","slug":{"_type":"slug","current":"jerry-liu"}}],"featured":false,"htmlContent":"\u003ch1\u003eSummary\u003c/h1\u003e\u003cp\u003eIn this article, we compare how well LLM-powered agents with different degrees of complexity perform over practical data tasks (financial analysis). We compare the performance of agents with more \u003cem class=\"ow\"\u003ecomplex, unrestrained \u003c/em\u003einteraction behavior (ReAct) with agents that contain \u003cem class=\"ow\"\u003esimpler, more constrained \u003c/em\u003einteractions (routing). We specifically analyze how much complexity can be added to the agent layer vs. the tool layer.\u003c/p\u003e\u003cp\u003eWe find that the choice of the language model matters a lot. ReAct agents that are powered by “dumber” models (in a tongue-in-cheek fashion we are referring to any non GPT-4 model as “dumb”) struggle to return relevant results over data. We find that constraining agent interaction behavior, and giving them access to more tools that can more explicitly perform complex actions, can help improve query performance over these less sophisticated LLMs. In contrast, more sophisticated models (GPT-4) can more reliably utilize the ReAct loop to execute a variety of complex data queries.\u003c/p\u003e\u003cp\u003eThis blog post is quite detailed; we provide a \u003cem class=\"ow\"\u003elot \u003c/em\u003eof experiments and results below. Best of all, you can run this all yourself with our \u003ca href=\"https://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eexample notebook\u003c/a\u003e!\u003c/p\u003e\u003ch1\u003eOverview of Agents\u003c/h1\u003e\u003cp\u003eBuilding LLM-powered agents have gotten increasingly popular in the past few months. Frameworks like \u003ca href=\"https://github.com/hwchase17/langchain\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eLangChain\u003c/a\u003e have made it much easier to create these agents according to a set of common abstractions.\u003c/p\u003e\u003cp\u003eAt a high-level, an “agent” is essentially an automated decision engine, that can be used to interact with an external environment. The core agent loop looks something like the following:\u003c/p\u003e\u003col\u003e\u003cli\u003eThe agent has access to a set of “tools”, which are generic functions that it can perform. It has an awareness of each tool through some attached metadata, and it can call each tool (either as a function call or structured API).\u003c/li\u003e\u003cli\u003eUser feeds in a natural language input to the agent.\u003c/li\u003e\u003cli\u003eGiven the input, the agent \u003cstrong\u003einteracts with the set of tools \u003c/strong\u003ein some fashion and returns the response.\u003c/li\u003e\u003c/ol\u003e\u003cp\u003eThere’s a variety of ways to perform \u003cstrong\u003eagent-tool interaction.\u003c/strong\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003eThe most popular is probably \u003ca href=\"https://arxiv.org/abs/2210.03629\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eReAct\u003c/a\u003e: the agent reasons over the next action, constructs an action command, executes the action. It repeats these steps in an iterative loop until the task is complete.\u003c/li\u003e\u003cli\u003eThere are other interaction modes too. Recently there was a paper on \u003ca href=\"https://arxiv.org/pdf/2305.04091.pdf\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003ePlan-and-solve Prompting\u003c/a\u003e, which generates a plan beforehand (to decompose a complex task into simpler ones). Before ReAct there have also been related techniques on \u003ca href=\"https://arxiv.org/abs/2210.03350\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eSelf-Ask\u003c/a\u003e and \u003ca href=\"https://arxiv.org/abs/2201.11903\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eChain of Thought Prompting\u003c/a\u003e.\u003c/li\u003e\u003c/ul\u003e\u003ch2\u003e“Complex” vs. “Simple” Agent Interaction Techniques\u003c/h2\u003e\u003cp\u003eWe classify techniques like ReAct are more \u003cem class=\"ow\"\u003ecomplex and unconstrained: \u003c/em\u003ethis is because they perform iterative reasoning and also break the input into smaller steps. Complicated agent interaction loops allow for more \u003cem class=\"ow\"\u003efreedom of behavior, \u003c/em\u003eand\u003cem class=\"ow\"\u003e \u003c/em\u003ecreate an increased burden on the LLM being used. The pro of complex interaction frameworks is that they can be more general and handle a broader class of queries over simple tools. The con is that if the LLM is not up to par, then these frameworks are prone to making mistakes; unconstrained behavior can lead to unexpected results.\u003c/p\u003e\u003cp\u003eOn the other end of the spectrum, you can imagine a \u003cem class=\"ow\"\u003esimple and constrained \u003c/em\u003eagent interaction mechanism, where the agent does one-step selection of the underlying tool to use, and returns the response from the tool. The agent essentially just acts as a router from the query to Tool. There are no steps to break down the question into smaller ones, and no iterative chain-of-thought loops. The pro here is that the model will likely make fewer errors. The con here is that the interaction technique allows for less freedom and imposes more constraints on behavior.\u003c/p\u003e\u003ch2\u003eInvestigating Agent Interaction Techniques for Data Querying\u003c/h2\u003e\u003cp\u003eWe at LlamaIndex are interested in how agents can help augment data tasks. More specifically, we are interested in how agents can help perform complex user queries over a diverse range of data sources. This includes not only asking questions over a single document, but being able to synthesize insights across multiple documents and return that to the user.\u003c/p\u003e\u003cp\u003eLlamaIndex query engines can be used as Tools within an agent construct to query your data (we provide \u003ca href=\"https://gpt-index.readthedocs.io/en/latest/how_to/integrations/using_with_langchain.html\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eseamless integrations with LangChain\u003c/a\u003e). These Tools can vary in complexity. For instance, a \u003cem class=\"ow\"\u003esimple \u003c/em\u003eTool could be our \u003ca href=\"https://gpt-index.readthedocs.io/en/latest/how_to/integrations/vector_stores.html\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003evector store query engine\u003c/a\u003e, which does top-k embedding retrieval from a vector store. A more \u003cem class=\"ow\"\u003eadvanced\u003c/em\u003e tool could be a query engine over our graph data structure, which can be setup to \u003ca href=\"https://gpt-index.readthedocs.io/en/latest/use_cases/queries.html#compare-contrast-queries\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eexplicitly provide compare/contrast capabilities\u003c/a\u003e over any subset of documents. The tool itself can contain “agent-like” decision-making capabilities under the hood. LlamaIndex provides a variety of modules around \u003ca href=\"https://gpt-index.readthedocs.io/en/latest/examples/query_engine/RouterQueryEngine.html\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003erouting\u003c/a\u003e, \u003ca href=\"https://gpt-index.readthedocs.io/en/latest/how_to/query/query_transformations.html#single-step-query-decomposition\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003equery decomposition\u003c/a\u003e, and \u003ca href=\"https://gpt-index.readthedocs.io/en/latest/examples/query_engine/sub_question_query_engine.html\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003emulti-part query planning\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eIn this blog post, we are interested in comparing the following approaches to designing agents and tools to see which approach can provide good answers to different user queries in a robust fashion:\u003c/p\u003e\u003cul\u003e\u003cli\u003emore \u003cem class=\"ow\"\u003ecomplex and unconstrained \u003c/em\u003eagent interaction (ReAct) over a set of \u003cem class=\"ow\"\u003esimple \u003c/em\u003eTools\u003c/li\u003e\u003cli\u003emore \u003cem class=\"ow\"\u003esimple and constrained \u003c/em\u003eagent interaction (simple routing) that uses more \u003cem class=\"ow\"\u003ecomplex \u003c/em\u003eTools\u003c/li\u003e\u003c/ul\u003e\u003cfigure\u003e\u003cfigcaption class=\"qp fe qq qb qc qr qs be b bf z dt\"\u003eComplex Agents with Simple Tools, Simple Agents with Complex Tools\u003c/figcaption\u003e\u003cimg src=\"/blog/images/1*R4zNJYl_k47ZvAbapWe70Q.png\" alt=\"\" width=\"700\" height=\"307\"\u003e\u003c/figure\u003e\u003cp\u003eEssentially what we are interested in is how much complexity can be pushed to the agent interaction layer vs. being left in the Tool layer. We explore the following concrete example: let’s say the user query is to compare/contrast two different documents (a relatively complex query). If the set of Tools are all just vector indices over different documents, could the agent interaction loop figure out how to execute that query reliably against the vector indices? On the other hand, if we push the complexity down to the Tool layer, then we could \u003cem class=\"ow\"\u003eexplicitly \u003c/em\u003ehave a Tool that can perform “compare/contrast” over your Documents. Then the burden on the agent is to simply call this Tool instead of interacting with a set of other tools in a more complex fashion.\u003c/p\u003e\u003ch2\u003eHigh-Level Findings\u003c/h2\u003e\u003cp\u003eThe high-level finding is that \u003cstrong\u003eless sophisticated agents need more constraints. \u003c/strong\u003eMore specifically, we found that using a GPT-3 powered agent in a ReAct loop did not provide good results over complex queries; it was not able to figure out the proper interaction pattern over the provided set of Tools in order to surface the results. Instead, by adding more constraints to the agent behavior and providing more sophistication in the Tool itself, we were able to get a GPT-3 agent to produce better results.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSmarter agents require fewer constraints. \u003c/strong\u003eWe did find that GPT-4 agents with ReAct were able to provide better query results than GPT-3 agents when presented with a set of simple Tools over the data. This implies that more powerful agents may not need as many tools to “explicitly” perform tasks when much of that logic can be handled in the agent interaction loop.\u003c/p\u003e\u003ch1\u003eSetup\u003c/h1\u003e\u003cp\u003eOur data consists of three Uber 10-Q filings (quarterly financial reports) in 2022: March, June, and September. We wish to execute different queries over this data; the bulk of these queries are around comparing different bits of information between these documents.\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"78ce\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003emarch_2022 = SimpleDirectoryReader(input_files=[\"../data/10q/uber_10q_march_2022.pdf\"]).load_data()\njune_2022 = SimpleDirectoryReader(input_files=[\"../data/10q/uber_10q_june_2022.pdf\"]).load_data()\nsept_2022 = SimpleDirectoryReader(input_files=[\"../data/10q/uber_10q_sept_2022.pdf\"]).load_data()\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eWe use LlamaIndex to define a vector index over each document, which just stores the document chunks + embeddings in a vector store. We can then query each vector index using a simple\u003ccode class=\"cw rc rd re qu b\"\u003eQueryEngine\u003c/code\u003e . We create a tool for each of these\u003ccode class=\"cw rc rd re qu b\"\u003eQueryEngine\u003c/code\u003e objects.\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"7ecb\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003e# define indices\nmarch_index = GPTVectorStoreIndex.from_documents(march_2022)\njune_index = GPTVectorStoreIndex.from_documents(june_2022)\nsept_index = GPTVectorStoreIndex.from_documents(sept_2022)\n\n# define query engine\nmarch_engine = march_index.as_query_engine(similarity_top_k=3)\njune_engine = june_index.as_query_engine(similarity_top_k=3)\nsept_engine = sept_index.as_query_engine(similarity_top_k=3)\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eWe also define a \u003ccode class=\"cw rc rd re qu b\"\u003eComposableGraph\u003c/code\u003e over these three documents. The composable graph roughly follows the \u003ca href=\"https://gpt-index.readthedocs.io/en/latest/use_cases/queries.html#compare-contrast-queries\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eguide described here\u003c/a\u003e. This graph is explicitly setup to perform compare/contrast queries over these three documents.\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"a152\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003egraph = ComposableGraph.from_indices(\n    GPTListIndex,\n    children_indices=[march_index, june_index, sept_index],\n    index_summaries=[\n        \"Provides information about Uber quarterly financials ending March 2022\",\n        \"Provides information about Uber quarterly financials ending June 2022\",\n        \"Provides information about Uber quarterly financials ending September 2022\"\n    ]\n)\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eThe graph can be queried with a \u003ccode class=\"cw rc rd re qu b\"\u003eComposableGraphQueryEngine\u003c/code\u003e :\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"9190\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003e\u003cspan class=\"hljs-comment\"\u003e# define decompose_transform\u003c/span\u003e\ndecompose_transform = DecomposeQueryTransform(verbose=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# define custom query engines\u003c/span\u003e\ncustom_query_engines = {}\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e index \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e [march_index, june_index, sept_index]:\n    query_engine = index.as_query_engine(service_context=service_context)\n    query_engine = TransformQueryEngine(\n        query_engine,\n        query_transform=decompose_transform,\n        transform_extra_info={\u003cspan class=\"hljs-string\"\u003e'index_summary'\u003c/span\u003e: index.index_struct.summary},\n    )\n    custom_query_engines[index.index_id] = query_engine\n\ncustom_query_engines[graph.root_id] = graph.root_index.as_query_engine(\n    service_context=service_context,\n    streaming=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e,\n)\n\n\u003cspan class=\"hljs-comment\"\u003e# define graph\u003c/span\u003e\ng_engine = graph.as_query_engine(\n    custom_query_engines=custom_query_engines\n)\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eWe try the following agent setups:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cstrong\u003eGPT-3 ReAct agent: \u003c/strong\u003eA zero-shot GPT-3 ReAct agent with three Tools: each Tool corresponds to the vector index over a 10-Q filing.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eGPT-4 ReAct agent: \u003c/strong\u003eSame as above but using GPT-4 instead.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eSimple Router agent: \u003c/strong\u003eA simple router “agent” with four Tools: the three Tools listed above + the \u003ccode class=\"cw rc rd re qu b\"\u003eComposableGraphQueryEngine\u003c/code\u003e explicitly setup to perform compare/contrast queries.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe code snippets for initializing these agents are below. For the simple router agent, we use the native \u003ccode class=\"cw rc rd re qu b\"\u003eRouterQueryEngine\u003c/code\u003e within LlamaIndex, though you should also be able to achieve similar results in LangChain through either the zero-shot agent (with tweaked settings) or the router chain.\u003c/p\u003e\u003ch2\u003e\u003cstrong\u003eGPT-3/GPT-4 ReAct Agent Setup\u003c/strong\u003e\u003c/h2\u003e\u003cpre\u003e\u003cspan id=\"4d83\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003e\u003cspan class=\"hljs-comment\"\u003e# initializing zero-shot ReAct agent\u003c/span\u003e\n\nuber_config_sept = IndexToolConfig(\n    query_engine=sept_engine, \n    name=\u003cspan class=\"hljs-string\"\u003ef\"Uber 10Q September 2022\"\u003c/span\u003e,\n    description=\u003cspan class=\"hljs-string\"\u003ef\"Provides information about Uber quarterly financials ending September 2022\"\u003c/span\u003e,\n    tool_kwargs={\u003cspan class=\"hljs-string\"\u003e\"return_direct\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e}\n)\nuber_config_june = IndexToolConfig(\n    query_engine=june_engine, \n    name=\u003cspan class=\"hljs-string\"\u003ef\"Uber 10Q June 2022\"\u003c/span\u003e,\n    description=\u003cspan class=\"hljs-string\"\u003ef\"Provides information about Uber quarterly financials ending June 2022\"\u003c/span\u003e,\n    tool_kwargs={\u003cspan class=\"hljs-string\"\u003e\"return_direct\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e}\n)\nuber_config_march = IndexToolConfig(\n    query_engine=march_engine, \n    name=\u003cspan class=\"hljs-string\"\u003ef\"Uber 10Q March 2022\"\u003c/span\u003e,\n    description=\u003cspan class=\"hljs-string\"\u003ef\"Provides information about Uber quarterly financials ending March 2022\"\u003c/span\u003e,\n    tool_kwargs={\u003cspan class=\"hljs-string\"\u003e\"return_direct\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e}\n)\n\ntoolkit = LlamaToolkit(\n    index_configs=[uber_config_sept, uber_config_june, uber_config_march],\n)\n\n\u003cspan class=\"hljs-comment\"\u003e# this is a light wrapper around `initialize_agent` in langchain (which defaults to zero-shot)\u003c/span\u003e\nagent_chain = create_llama_agent(\n    toolkit,\n    llm, \u003cspan class=\"hljs-comment\"\u003e# can be GPT-3 or GPT-4 \u003c/span\u003e\n    verbose=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e\n)\u003c/span\u003e\u003c/pre\u003e\u003ch2\u003eSimple Router Agent Setup\u003c/h2\u003e\u003cpre\u003e\u003cspan id=\"15e1\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003e\nquery_tool_sept = QueryEngineTool.from_defaults(\n    query_engine=sept_engine,\n    description=f\"Provides information about Uber quarterly financials ending September 2022\",\n)\nquery_tool_june = QueryEngineTool.from_defaults(\n    query_engine=june_engine,\n    description=f\"Provides information about Uber quarterly financials ending June 2022\",\n)\nquery_tool_march = QueryEngineTool.from_defaults(\n    query_engine=march_engine,\n    description=f\"Provides information about Uber quarterly financials ending March 2022\",\n)\nquery_tool_graph = QueryEngineTool.from_defaults(\n    query_engine=g_engine,\n    description=f\"Provides comparisons between Uber financials across quarters in 2022. Can be used to answer \"\n                 \"any questions that require analysis across multiple quarters.\",\n)\n\n# our \"router\" query engine is effectively a simple agent that can only perform routing\nquery_engine = RouterQueryEngine(\n    selector=LLMSingleSelector.from_defaults(),\n    query_engine_tools=[\n        query_tool_sept,\n        query_tool_june,\n        query_tool_march,\n        query_tool_graph\n    ]\n)\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eNow that we’ve described the setup, let’s take a look at the results below!\u003c/p\u003e\u003ch1\u003eFindings and Experiments\u003c/h1\u003e\u003cp\u003eAt a high-level, we find using GPT-3 in ReAct agents produces suboptimal results over these queries. They tend to exhibit the following characteristics:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cstrong\u003eUnpredictability in the set of chosen tools: \u003c/strong\u003eThe set of tools chosen can differ even if the questions are semantically similar, leading to variability in the responses.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLack of coverage in the set of chosen tools: \u003c/strong\u003eOftentimes we expect that a given question is able to make use of all three 10-Q statements, but only a subset of them are picked.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eErroneous chain-of-thought processing: \u003c/strong\u003eSometimes the agent uses tools throughout the CoT process that are irrelevant to the question.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eIn contrast, we find that GPT-4 ReAct agents provide answers that are more relevant, predictable, and exhibit fewer errors in intermediate results.\u003c/p\u003e\u003cp\u003eFinally, we find that using a simpler routing-only GPT-3 agent with access to an explicit “compare/contrast” tool allows the agent to perform better.\u003c/p\u003e\u003cp\u003eAs a reminder, full results are in the notebook: \u003ca href=\"https://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003ehttps://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing\u003c/a\u003e\u003c/p\u003e\u003ch2\u003eGPT-3 ReAct Agent Results\u003c/h2\u003e\u003cp\u003e\u003cstrong\u003eQuery 1\u003c/strong\u003e\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"19d6\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eagent_chain.run(input=\"Analyze Uber revenue growth over the last few quarters\")\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eResponse:\u003c/p\u003e\u003cfigure\u003e\u003cimg src=\"/blog/images/1*Rwh0f3D-D-KhpiG3hAoSkw.png\" alt=\"\" width=\"700\" height=\"263\"\u003e\u003c/figure\u003e\u003cp\u003eWe see that only the September 10-Q filing is chosen to answer the question. The September 10-Q does contain some information about revenue growth compared to the same period in 2021, but that doesn’t explicitly answer the question, which is about revenue growth the past few quarters.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eQuery 2\u003c/strong\u003e\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"8ad0\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eagent_chain.run(input=\"Analyze changes in risk factors for Uber\")\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eResponse:\u003c/p\u003e\u003cfigure\u003e\u003cimg src=\"/blog/images/1*R7zJfetsc8mXhG4kW8_Siw.png\" alt=\"\" width=\"700\" height=\"491\"\u003e\u003c/figure\u003e\u003cp\u003eThe September and June 10-Q filings are chosen, but not March. Moreover, the answer is vague and doesn’t provide much detail regarding concrete risk factors for Uber (and also mentions that the risk factors “have changed over the past three quarters” even though it’s only using two Tools).\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eQuery 3\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eIn this query, we more explicitly showcase how slight changes in prompts can induce different chain-of-thought paths through different Tools, and as a result produce different answers.\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"0f43\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003e# Prompt variation 1 \nagent_chain.run(input=\"Analyze Uber revenue growth and risk factors over time\")\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eResponse:\u003c/p\u003e\u003cfigure\u003e\u003cimg src=\"/blog/images/1*AbOFy6vaAQ3vijwhV5V1ug.png\" alt=\"\" width=\"700\" height=\"426\"\u003e\u003c/figure\u003e\u003cpre\u003e\u003cspan id=\"7806\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003e# Prompt variation 2\nagent_chain.run(input=\"Analyze Uber revenue growth and risk factors over quarters\")\u003c/span\u003e\u003c/pre\u003e\u003cfigure\u003e\u003cimg src=\"/blog/images/1*LgCbvrqwEGROw_vma0l4QA.png\" alt=\"\" width=\"700\" height=\"484\"\u003e\u003c/figure\u003e\u003cp\u003eThe main difference between these two queries is “over time” versus “over quarters.” As we can see, not only are the selected Tools different between the two variations, but the inputs are different as well — in the first it’s “financials”, and in the second it’s “Revenue growth and risk factors.”\u003c/p\u003e\u003cp\u003eSince the Tool input in the first variant is unrelated to the question, the answer is similarly vague: “Uber’s revenue growth and risk factors can be analyzed by comparing the financials…”\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eQuery 4:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eHere instead of asking a compare/contrast question let’s just ask a question about a given statement.\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"603f\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eagent_chain.run(input=\"How much cash did Uber have in sept 2022?\")\u003c/span\u003e\u003c/pre\u003e\u003cfigure\u003e\u003cimg src=\"/blog/images/1*A7bhWOv5Z3HdTp2iafR3sA.png\" alt=\"\" width=\"700\" height=\"331\"\u003e\u003c/figure\u003e\u003cp\u003eWe see that the agent makes two errors 1) it is not able to supply an action input to each Tool, and 2) ends up looking through the June and March filings which are irrelevant to the question.\u003c/p\u003e\u003ch2\u003eGPT-4 ReAct Agent Results\u003c/h2\u003e\u003cp\u003eGPT-4 ReAct agents perform a lot better than GPT-3 agents. They comprehensively go through the set of available Tools, and provide much more detailed observation extraction and response synthesis.\u003c/p\u003e\u003cp\u003eWe won’t go through all of these examples, but they can be found in the example notebook!\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eQuery 1:\u003c/strong\u003e\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"24a6\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eagent_chain_gpt4.run(input=\"Analyze Uber revenue growth over the last few quarters\")\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eResponse:\u003c/p\u003e\u003cfigure\u003e\u003cimg src=\"/blog/images/1*PJDOtqVHKJ9I_l6rICp6dQ.png\" alt=\"\" width=\"700\" height=\"232\"\u003e\u003c/figure\u003e\u003cp\u003eUnlike the GPT-3 agent, here the GPT-4 agent at least goes through every filing and synthesizes the result.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eQuery 2\u003c/strong\u003e\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"4716\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eagent_chain_gpt4.run(input=\"Analyze changes in risk factors for Uber\")\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eResponse:\u003c/p\u003e\u003cfigure\u003e\u003cimg src=\"/blog/images/1*VBPGlCvcyjaRYEpXChGm2w.png\" alt=\"\" width=\"700\" height=\"465\"\u003e\u003c/figure\u003e\u003cp\u003eHere the GPT-4 agent still only looks at September and June (and skips March), but the response is way more detailed, and references concrete facts within the report.\u003c/p\u003e\u003ch2\u003eGPT-3 Router Agent Results\u003c/h2\u003e\u003cp\u003eReminder: the router agent doesn’t do any CoT and has additional access to our ComposableGraph query engine, which can explicitly perform compare/contrast queries. Let’s take a look at how this agent does.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eQuery 1\u003c/strong\u003e\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"2e7e\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eresponse = query_engine.query(\"Analyze Uber revenue growth over the last few quarters\")\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eResponse (intermediate steps):\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"9a3e\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eSelecting query engine 3: Provides comparisons between Uber financials across quarters in 2022. Can be used to answer any questions that require analysis across multiple quarters..\n\u0026gt; Current query: Analyze Uber revenue growth over the last few quarters\n\u0026gt; New query:  What was Uber's revenue growth from the last quarter ending March 2022 compared to the previous quarter?\n\u0026gt; Current query: Analyze Uber revenue growth over the last few quarters\n\u0026gt; New query:  What was Uber's revenue growth from the last quarter ending June 2022 compared to the previous quarter?\n\u0026gt; Current query: Analyze Uber revenue growth over the last few quarters\n\u0026gt; New query:  What was Uber's revenue growth from the last few quarters ending September 2022?\n\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eFinal Response\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"66e2\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eBased on the limited context information provided, we can only analyze Uber's revenue growth for two specific quarters:\n\n1. For the quarter ending March 2022, Uber's revenue growth increased compared to the first quarter of 2021. However, the exact percentage of growth is not provided.\n\n2. For the quarter ending September 2022, Uber's revenue growth was 72%.\n\nUnfortunately, we do not have enough data to analyze the revenue growth for the quarters ending June 2022 or to compare it to the previous quarter. To provide a more comprehensive analysis, additional data on Uber's revenue growth for other quarters would be needed.\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eTo be fair, this response does not cover the month of June. But the fault of that lies with the implementation of the Tool itself rather than the agent interaction step. The agent’s only job is to pick the right Tool to solve the task at hand, and it does that job correctly; it decides to choose the Tool corresponding to our \u003ccode class=\"cw rc rd re qu b\"\u003eComposableGraphQueryEngine\u003c/code\u003e abstraction (which can perform compare/contrast queries).\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eQuery 2\u003c/strong\u003e\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"e2bd\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eresponse = query_engine.query(\"Analyze changes in risk factors for Uber\")\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eResponse (intermediate steps):\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"58e3\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003e\u003cspan class=\"hljs-variable constant_\"\u003eINFO\u003c/span\u003e\u003cspan class=\"hljs-symbol\"\u003e:llama_index\u003c/span\u003e.query_engine.\u003cspan class=\"hljs-symbol\"\u003erouter_query_engine:\u003c/span\u003e\u003cspan class=\"hljs-title class_\"\u003eSelecting\u003c/span\u003e query engine \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eProvides\u003c/span\u003e comparisons between \u003cspan class=\"hljs-title class_\"\u003eUber\u003c/span\u003e financials across quarters \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e. \u003cspan class=\"hljs-title class_\"\u003eCan\u003c/span\u003e be used to answer any questions that \u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e analysis across multiple quarters..\n\u003cspan class=\"hljs-title class_\"\u003eSelecting\u003c/span\u003e query engine \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eProvides\u003c/span\u003e comparisons between \u003cspan class=\"hljs-title class_\"\u003eUber\u003c/span\u003e financials across quarters \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e. \u003cspan class=\"hljs-title class_\"\u003eCan\u003c/span\u003e be used to answer any questions that \u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e analysis across multiple quarters..\n\u0026amp;gt; \u003cspan class=\"hljs-title class_\"\u003eCurrent\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003equery:\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAnalyze\u003c/span\u003e changes \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e risk factors \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUber\u003c/span\u003e\n\u0026amp;gt; \u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003equery:\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eWhat\u003c/span\u003e are the risk factors \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUber\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the quarter ending \u003cspan class=\"hljs-title class_\"\u003eMarch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e?\n\u0026amp;gt; \u003cspan class=\"hljs-title class_\"\u003eCurrent\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003equery:\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAnalyze\u003c/span\u003e changes \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e risk factors \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUber\u003c/span\u003e\n\u0026amp;gt; \u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003equery:\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eWhat\u003c/span\u003e are the risk factors \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUber\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the quarter ending \u003cspan class=\"hljs-title class_\"\u003eJune\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e?\n\u0026amp;gt; \u003cspan class=\"hljs-title class_\"\u003eCurrent\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003equery:\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAnalyze\u003c/span\u003e changes \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e risk factors \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUber\u003c/span\u003e\n\u0026amp;gt; \u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003equery:\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eWhat\u003c/span\u003e are the risk factors \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUber\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e the quarter ending \u003cspan class=\"hljs-title class_\"\u003eSeptember\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e?\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eFinal Response\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"65a0\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eFrom the context information provided, we can analyze the changes in risk factors \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e Uber across the three quarters as follows:\n\n\u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e COVID\u003cspan class=\"hljs-number\"\u003e-19\u003c/span\u003e pandemic: The ongoing pandemic remains a constant risk factor across all quarters, with its impact on driver \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e courier supply constraints, consumer demand, \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e government restrictions. However, the specific concerns related to the pandemic may evolve, such as the emergence of \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e virus variants \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e changes in vaccination rates.\n\n\u003cspan class=\"hljs-number\"\u003e2.\u003c/span\u003e Driver \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e courier supply constraints: This risk factor is present in the quarter ending March \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e but is \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e explicitly mentioned in the subsequent quarters. However, it may still be an underlying concern, especially \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e the pandemic continues to impact driver availability.\n\n\u003cspan class=\"hljs-number\"\u003e3.\u003c/span\u003e Changes in consumer demand: This risk factor is mentioned in the quarter ending March \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, with an imbalance between Mobility \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e Delivery services. It is \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e explicitly mentioned in the subsequent quarters, but fluctuations in revenue due to changes in Gross Bookings \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e Mobility Trip volumes in the quarter ending June \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e could be related to changes in consumer demand.\n\n\u003cspan class=\"hljs-number\"\u003e4.\u003c/span\u003e Government restrictions \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e regulations: This risk factor is present in the quarter ending March \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, with the impact of restrictions on Mobility offerings. In the quarter ending June \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, the focus shifts to the potential impact of regulatory changes \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e legal claims, such as driver classification in the UK. In the quarter ending September \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, the risk factor of driver classification as employees, workers, \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e quasi-employees becomes more prominent.\n\n\u003cspan class=\"hljs-number\"\u003e5.\u003c/span\u003e Uncertainty around future developments: This risk factor is mentioned in the quarter ending March \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e but is \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e explicitly mentioned in the subsequent quarters. However, it may still be an underlying concern, especially with the ongoing impact of COVID\u003cspan class=\"hljs-number\"\u003e-19\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e potential permanent changes to end-users\u003cspan class=\"hljs-number\"\u003e'\u003c/span\u003e behavior.\n\n\u003cspan class=\"hljs-number\"\u003e6.\u003c/span\u003e Accounting pronouncements: This risk factor is introduced in the quarter ending June \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, with the adoption \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e impact of recently issued accounting pronouncements potentially affecting Uber\u003cspan class=\"hljs-number\"\u003e'\u003c/span\u003es consolidated financial statements.\n\n\u003cspan class=\"hljs-number\"\u003e7.\u003c/span\u003e Integration \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e performance of acquired businesses: This risk factor is introduced in the quarter ending June \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, with the acquisition of Transplace contributing to the increase in Freight revenue.\n\n\u003cspan class=\"hljs-number\"\u003e8.\u003c/span\u003e Competition: This risk factor is introduced in the quarter ending September \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, highlighting the highly competitive nature of the mobility, delivery, \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e logistics industries, \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e the need to lower fares, offer incentives, \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e promotions to remain competitive.\n\n\u003cspan class=\"hljs-number\"\u003e9.\u003c/span\u003e Significant losses \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e increasing operating expenses: This risk factor is introduced in the quarter ending September \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, emphasizing the financial challenges Uber faces in achieving profitability.\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eThe job of the agent is once again simple: it chooses the graph query engine that is optimized to perform “compare/contrast” queries. The result is much more detailed than the result obtained from the GPT-3 ReAct agent (and is comparable to the GPT-4 ReAct agent). It contains a detailed analysis of all risk factors in bullet points, and offers a comparison across time for all bullet points.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eQuery 3\u003c/strong\u003e\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"ef96\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eresponse = query_engine.query(\"Analyze Uber revenue growth and risk factors over the last few quarters\")\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eResponse (intermediate steps):\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"8dab\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003e\u0026gt; Current query: Analyze Uber revenue growth and risk factors over quarters\n\u0026gt; New query:  What is Uber's revenue growth and risk factors for the quarter ending March 2022?\n\u0026gt; Current query: Analyze Uber revenue growth and risk factors over quarters\n\u0026gt; New query:  What is Uber's revenue growth and risk factors for the quarter ending March 2022?\n\u0026gt; Current query: Analyze Uber revenue growth and risk factors over quarters\n\u0026gt; New query:  What is Uber's revenue growth and risk factors for the quarter ending June 2022?\n\u0026gt; Current query: Analyze Uber revenue growth and risk factors over quarters\n\u0026gt; New query:  What is Uber's revenue growth and risk factors for the quarter ending June 2022?\n\u0026gt; Current query: Analyze Uber revenue growth and risk factors over quarters\n\u0026gt; New query:  What were Uber's total revenues for the quarter ending September 2022?\n\u0026gt; Current query: Analyze Uber revenue growth and risk factors over quarters\n\u0026gt; New query:  What were Uber's total revenues for the quarter ending September 2022?\u003c/span\u003e\u003c/pre\u003e\u003cp\u003eFinal Response\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"c81b\" class=\"qx nb gt qu b bf qy qz l ra rb\"\u003eUber\u003cspan class=\"hljs-string\"\u003e's revenue growth has been impressive over the past few quarters, with the quarter ending March 2022 showing a 136% year-over-year growth and the quarter ending June 2022 showing a 105% year-over-year growth. The revenue for the quarter ending June 2022 was $8,343 million. \n\nThe risk factors for Uber'\u003c/span\u003es business have been largely related to the ongoing impacts of the COVID-\u003cspan class=\"hljs-number\"\u003e19\u003c/span\u003e pandemic, including reduced \u003cspan class=\"hljs-keyword\"\u003eglobal\u003c/span\u003e demand \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e Mobility rides, supply constraints, \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e potential permanent changes to end-user behavior. These risk factors have been present in both the quarter ending March \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e the quarter ending June \u003cspan class=\"hljs-number\"\u003e2022\u003c/span\u003e, though the specific risks have varied slightly.\u003c/span\u003e\u003c/pre\u003e\u003ch1\u003eConcluding Thoughts\u003c/h1\u003e\u003cp\u003eReAct-based agents offer a powerful, general reasoning loop, and have the potential to solve complex tasks over your data. But they tend to only work reliably with more powerful language models such as GPT-4. Less sophisticated models (e.g. GPT-3) will make more unpredictable and erroneous decisions, leading to subpar query performance over your data sources.\u003c/p\u003e\u003cp\u003eAgents implemented with “dumber” models need more interaction constraints in order to make more reliable, less erroneous decisions. We find that if we explicitly constrain the agent interface and push the complexity down to the Tool layer, we can still create agents that offer good performance over your data.\u003c/p\u003e\u003cp\u003eOf course, this is just an initial analysis and there’s a few caveats/limitations:\u003c/p\u003e\u003cul\u003e\u003cli\u003eYou may be able to “prompt hack” the default ReAct loop to get more consistent results, and we did not try that.\u003c/li\u003e\u003cli\u003eWe only tested this over a set of three financial documents. There’s a lot more work that needs to be done if we want to test this out on thousands of docs.\u003c/li\u003e\u003cli\u003eWe only compared GPT-3 and GPT-4, there’s so many more models to compare/benchmark, e.g ChatGPT, any open-source model, Anthropic Claude, etc.\u003c/li\u003e\u003cli\u003eWe did not test out other agent interaction patterns besides ReAct: “plan and solve” agents (though we do have similar formulations in LlamaIndex), AutoGPT-like task management, and more.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eWhether you’ve run into similar findings or you disagree with our analysis, let us know! We’d love to facilitate this discussion on our \u003ca href=\"https://discord.gg/dGcwcsnxhU\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003eDiscord\u003c/a\u003e.\u003c/p\u003e\u003ch2\u003eNotebook Walkthrough\u003c/h2\u003e\u003cp\u003eYou can find the full notebook walkthrough here: \u003ca href=\"https://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003ehttps://colab.research.google.com/drive/1uP38k4nr8OPmXbY4dLoKKQW0F29WtNuY?usp=sharing\u003c/a\u003e\u003c/p\u003e","image":{"_type":"image","asset":{"_ref":"image-51fec5920633a3007410529f10af91223e39f371-3343x1465-png","_type":"reference"}},"mainImage":"https://cdn.sanity.io/images/7m9jw85w/production/51fec5920633a3007410529f10af91223e39f371-3343x1465.png","publishedDate":"2023-05-23","relatedPosts":[{"featured":false,"image":{"_type":"image","asset":{"_ref":"image-a195d5cbe68a6c2cb0847c985ead93111909f0bf-3378x3265-webp","_type":"reference"}},"publishedDate":"2024-02-27","slug":"querying-a-network-of-knowledge-with-llama-index-networks-d784b4c3006f","title":"Querying a network of knowledge with llama-index-networks"},{"featured":false,"image":{"_type":"image","asset":{"_ref":"image-4ae00650dab860c90f1a8f797b33c1026438ba2f-1024x1024-png","_type":"reference"}},"publishedDate":"2024-02-17","slug":"multimodal-rag-for-advanced-video-processing-with-llamaindex-lancedb-33be4804822e","title":"MultiModal RAG for Advanced Video Processing with LlamaIndex \u0026 LanceDB"},{"featured":false,"image":{"_type":"image","asset":{"_ref":"image-0e45151b7b56fda591f51cebb87cbfc436bcb697-1024x1024-png","_type":"reference"}},"publishedDate":"2024-02-08","slug":"how-to-build-llm-agents-in-typescript-with-llamaindex-ts-a88ed364a7aa","title":"How to build LLM Agents in TypeScript with LlamaIndex.TS"},{"featured":false,"image":{"_type":"image","asset":{"_ref":"image-8890c5098dbde95bd57d8c230fb46ee60bede234-2400x1420-png","_type":"reference"}},"publishedDate":"2024-01-30","slug":"agentic-rag-with-llamaindex-2721b8a49ff6","title":"Agentic RAG With LlamaIndex"}],"slug":{"_type":"slug","current":"dumber-llm-agents-need-more-constraints-and-better-tools-17a524c59e12"},"tags":[{"_createdAt":"2024-02-22T20:19:11Z","_id":"3d5b5d70-cd50-435c-86e7-3ba4c4c44d61","_rev":"9mLWnJtMvL1OgKPLcXbz07","_type":"blogTag","_updatedAt":"2024-02-22T20:19:11Z","slug":{"_type":"slug","current":"artificial-intelligence"},"title":"Artificial Intelligence"},{"_createdAt":"2024-02-22T20:19:11Z","_id":"412f77ae-efba-466b-abc9-221fc36d252a","_rev":"9mLWnJtMvL1OgKPLcXbz07","_type":"blogTag","_updatedAt":"2024-02-22T20:19:11Z","slug":{"_type":"slug","current":"large-language-models"},"title":"Large Language Models"},{"_createdAt":"2024-02-22T20:19:13Z","_id":"78713226-8bff-400f-bbfe-fd8a3d90be1d","_rev":"9mLWnJtMvL1OgKPLcXbz07","_type":"blogTag","_updatedAt":"2024-02-22T20:19:13Z","slug":{"_type":"slug","current":"nlp"},"title":"NLP"},{"_createdAt":"2024-02-22T20:19:11Z","_id":"3e4feb2c-4916-495e-a9db-a829131f6c42","_rev":"9mLWnJtMvL1OgKPLcXbz07","_type":"blogTag","_updatedAt":"2024-02-22T20:19:11Z","slug":{"_type":"slug","current":"machine-learning"},"title":"Machine Learning"}],"title":"Dumber LLM Agents Need More Constraints and Better Tools"},"publishedDate":"Invalid Date"},"params":{"slug":"dumber-llm-agents-need-more-constraints-and-better-tools-17a524c59e12"},"draftMode":false,"token":""},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"dumber-llm-agents-need-more-constraints-and-better-tools-17a524c59e12"},"buildId":"C8J-EMc_4OCN1ch65l4fl","isFallback":false,"isExperimentalCompile":false,"gsp":true,"scriptLoader":[]}</script></body></html>