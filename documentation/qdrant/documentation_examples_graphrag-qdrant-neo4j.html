<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta charset=UTF-8><title>GraphRAG with Qdrant and Neo4j - Qdrant</title>
<link rel=icon href=https://qdrant.tech/favicon/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=https://qdrant.tech/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://qdrant.tech/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://qdrant.tech/favicon/favicon-16x16.png><link rel=manifest href=https://qdrant.tech/favicon/site.webmanifest><link rel=mask-icon href=https://qdrant.tech/favicon/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#2b5797"><meta name=msapplication-config content="/favicon/browserconfig.xml"><meta name=theme-color content="#ffffff"><meta name=partition content="build"><link href=https://qdrant.tech/css/search/search.min.09596ee2b3c94d0ac82a1c33199cabdb3e0210b1ee46aaf1515200e9e484d05dd9e27cc1e861c58cc2e582af162f63b8e180ff2a12f7a6592b7aeaa0a7125130.css rel=stylesheet integrity="sha512-CVlu4rPJTQrIKhwzGZyr2z4CELHuRqrxUVIA6eSE0F3Z4nzB6GHFjMLlgq8WL2O44YD/KhL3plkreuqgpxJRMA=="><link href=https://qdrant.tech/css/documentation.min.de204cdcfc410689a41c17bcdad0a34f2caaa50cc8505c820adaab481cef2d69a920b0a32e0d624701c29487e3271b694559d98c5047cbfaa5aa475f638011e5.css rel=stylesheet integrity="sha512-3iBM3PxBBomkHBe82tCjTyyqpQzIUFyCCtqrSBzvLWmpILCjLg1iRwHClIfjJxtpRVnZjFBHy/qlqkdfY4AR5Q=="><meta name=generator content="Hugo 0.141.0"><meta name=description content="A step-by-step guide on implementing GraphRAG with Qdrant and Neo4j, combining vector search with knowledge graphs for enhanced retrieval."><meta name=keywords content="vector search engine,neural network,matching,SaaS,approximate nearest neighbor search,image search,recommender system,vectors,knn algorithm,hnsw,vector search,embeddings,similarity,simaes networks,BERT,transformer,word2vec,fasttext,qdrant"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@id":"https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/#article","@type":"Article","abstract":"A stepbystep guide on implementing GraphRAG with Qdrant and Neo4j combining vector search with knowledge graphs for enhanced retrieval","author":{"@type":"Organization","name":"Qdrant","url":"https://qdrant.tech/"},"dateModified":"0001-01-01 00:00:00 +0000 UTC","datePublished":"0001-01-01 00:00:00 +0000 UTC","description":"A stepbystep guide on implementing GraphRAG with Qdrant and Neo4j combining vector search with knowledge graphs for enhanced retrieval","headline":"GraphRAG with Qdrant and Neo4j","image":["https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/social_preview.png"],"name":"GraphRAG with Qdrant and Neo4j","url":"https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/","wordCount":"3787"},{"@id":"https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/#organization","@type":"Organization","address":{"@type":"PostalAddress","addressCountry":"DE","addressLocality":"Berlin","addressRegion":"Berlin","postalCode":"10115","streetAddress":"Chausseestra√üe 86"},"contactPoint":{"@type":"ContactPoint","contactType":"customer support","email":"info@qdrant.com","telephone":"+49 3040797694"},"description":"Qdrant is an Open-Source Vector Database and Vector Search Engine written in Rust. It provides fast and scalable vector similarity search service with convenient API.","email":"info@qdrant.com","founders":[{"@type":"Person","name":"map[email:info@qdrant.tech name:Andrey Vasnetsov]"},{"@type":"Person","name":"Andre Zayarni"}],"foundingDate":"2021","keywords":["vector search engine","neural network","matching","SaaS","approximate nearest neighbor search","image search","recommender system","vectors","knn algorithm","hnsw","vector search","embeddings","similarity","simaes networks","BERT","transformer","word2vec","fasttext","Qdrant"],"legalName":"Qdrant Solutions GmbH","location":"Berlin, Germany","logo":"https://qdrant.tech/images/logo_with_text.png","name":"Qdrant","sameAs":["https://github.com/qdrant/qdrant","https://qdrant.to/discord","https://www.youtube.com/channel/UC6ftm8PwH1RU_LM1jwG0LQA","https://www.linkedin.com/company/qdrant/","https://twitter.com/qdrant_engine"],"url":"https://qdrant.tech"}]}</script><meta property="og:url" content="https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/"><meta property="og:type" content="website"><meta property="og:title" content="GraphRAG with Qdrant and Neo4j - Qdrant"><meta name=twitter:card content="summary_large_image"><meta name=twitter:domain content="qdrant"><meta name=twitter:url content="https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/"><meta name=twitter:title content="GraphRAG with Qdrant and Neo4j - Qdrant"><meta property="og:description" content="A step-by-step guide on implementing GraphRAG with Qdrant and Neo4j, combining vector search with knowledge graphs for enhanced retrieval."><meta name=twitter:description content="A step-by-step guide on implementing GraphRAG with Qdrant and Neo4j, combining vector search with knowledge graphs for enhanced retrieval."><meta name=image property="og:image" content="https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/social_preview.png"><meta name=image property="og:image:secure_url" content="https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/social_preview.png"><meta property="og:image:type" content="image/jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name=twitter:image:src content="https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/social_preview.png"><link rel=canonical href=https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/><script type=text/javascript src=//js-eu1.hsforms.net/forms/embed/v2.js></script><script src=https://qdrant.tech/js/documentation.min.594fc9226f6fb87b8c3b0cafb9d5c0b0bcd95f47d292b929aab04315e0506706b2f376dc4fae9961dc3082138cb19d45b2a3370ee8e881bbf4b8c91dcb735c32.js></script></head><body><main><header class=docs-header><div class="main-menu z-5"><a href=https://qdrant.tech/><div class=logo><img class=logo__img src=https://qdrant.tech/img/qdrant-logo.svg alt=logo></div></a><div class="d-flex d-xl-none justify-content-end align-items-center gap-4"><div class="d-block d-xl-none"><button role=button class=theme-switch></button></div><button type=button class=main-menu__trigger><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M1 12H23" stroke="#e1e5f0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M1 5H23" stroke="#e1e5f0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M1 19H23" stroke="#e1e5f0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button></div><ul class=main-menu__links><li class=main-menu__item><a class=menu-link href=https://qdrant.tech/documentation/>Qdrant</a></li><li class=main-menu__item><a class=menu-link href=https://qdrant.tech/documentation/cloud-intro/>Cloud</a></li><li class=main-menu__item><a class=menu-linkactive href=https://qdrant.tech/documentation/build/>Build</a></li><li class=main-menu__item><a class=menu-link href=https://qdrant.tech/articles/>Learn</a></li><li class=main-menu__item><a class=menu-link href=https://api.qdrant.tech/api-reference target=_blank>API Reference</a></li></ul><div class=main-menu__buttons><div class=main-menu__buttons-input><button class="qdr-search-input-btn q-input input_md input_light-bg" type=button name=search data-target=#searchModal>
Search</button></div><button role=button class=theme-switch></button>
<a data-metric-loc=nav href=https://cloud.qdrant.io/login class="menu-link mx-3" target=_blank>Log in</a>
<a data-metric-loc=nav href=https://cloud.qdrant.io/signup class="button button_contained button_sm" target=_blank>Start Free</a></div></div><div class=menu-mobile><div class=menu-mobile__header><div class=logo><img class=logo__img src=https://qdrant.tech/img/qdrant-logo.svg alt=logo></div><div class="d-flex d-xl-none justify-content-end align-items-center gap-4"><div class="d-block d-xl-none"><button role=button class=theme-switch></button></div><button type=button class=menu-mobile__close><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><g id="Close"><path id="Vector" fill-rule="evenodd" clip-rule="evenodd" d="M19.778 5.63606C20.1685 5.24554 20.1685 4.61237 19.778 4.22185 19.3874 3.83132 18.7543 3.83132 18.3637 4.22185L11.9998 10.5858 5.63586 4.22185c-.39052-.39053-1.02369-.39053-1.41421.0C3.83112 4.61237 3.83112 5.24554 4.22165 5.63606L10.5856 12l-6.364 6.364C3.83108 18.7545 3.83108 19.3877 4.2216 19.7782 4.61213 20.1687 5.24529 20.1687 5.63582 19.7782l6.36398-6.364 6.364 6.364C18.7543 20.1687 19.3875 20.1687 19.778 19.7782 20.1685 19.3877 20.1685 18.7545 19.778 18.364L13.414 12l6.364-6.36394z" fill="#e1e5f0"/></g></svg></button></div></div><div class=main-menu__buttons-input><button class="qdr-search-input-btn q-input input_md input_light-bg" type=button name=search data-target=#searchModal>
Search</button></div><ul class=menu-mobile__items><li class=menu-mobile__item data-path=menu-0><div class=menu-mobile__item-content><a href=https://qdrant.tech/documentation/><svg width="16" height="16" viewBox="0 0 16 16" fill="#e1e5f0"><g id="Menu/Documentation"><path id="Vector" fill-rule="evenodd" clip-rule="evenodd" d="M4.25 1c-1.10092.0-2.12247.23681-2.88689.64443C.620129 2.04063.0 2.67297.0 3.5v11c0 .2761.223858.5.5.5s.5-.2239.5-.5c0-.278.21937-.6456.83364-.9732C2.42647 13.2107 3.27992 13 4.25 13 5.22008 13 6.07353 13.2107 6.66636 13.5268c.61427.3276.83364.6952.83364.9732.0.2761.22386.5.5.5s.5-.2239.5-.5c0-.278.21937-.6456.833640000000001-.9732C9.92647 13.2107 10.7799 13 11.75 13S13.5735 13.2107 14.1664 13.5268C14.7806 13.8544 15 14.222 15 14.5c0 .2761.2239.5.5.5s.5-.2239.5-.5V3.5C16 2.67297 15.3799 2.04063 14.6369 1.64443 13.8725 1.23681 12.8509 1 11.75 1s-2.12247.23681-2.88689.64443C8.53799 1.8178 8.2364 2.03638 8 2.29671c-.2364-.26033-.53799-.47891-.86311-.65228C6.37247 1.23681 5.35092 1 4.25 1zM1.36311 12.6444C1.23778 12.7113 1.11595 12.7848 1 12.8649V3.5c0-.27797.21937-.64563.83364-.97318C2.42647 2.21069 3.27992 2 4.25 2c.97008.0 1.82353.21069 2.41636.52682C7.28063 2.85437 7.5 3.22203 7.5 3.5v9.3649C7.38405 12.7848 7.26222 12.7113 7.13689 12.6444 6.37247 12.2368 5.35092 12 4.25 12 3.14908 12 2.12753 12.2368 1.36311 12.6444zM8.5 12.8649C8.61595 12.7848 8.73778 12.7113 8.86311 12.6444 9.62753 12.2368 10.6491 12 11.75 12S13.8725 12.2368 14.6369 12.6444C14.7622 12.7113 14.8841 12.7848 15 12.8649V3.5C15 3.22203 14.7806 2.85437 14.1664 2.52682 13.5735 2.21069 12.7201 2 11.75 2s-1.82353.21069-2.41636.52682C8.71937 2.85437 8.5 3.22203 8.5 3.5v9.3649z"/></g></svg>
Qdrant</a></div></li><li class=menu-mobile__item data-path=menu-1><div class=menu-mobile__item-content><a href=https://qdrant.tech/documentation/cloud-intro/><svg width="16" height="16" viewBox="0 0 16 16" fill="#e1e5f0"><g id="Menu/Cloud"><path id="Vector" fill-rule="evenodd" clip-rule="evenodd" d="M7.5 2C4.57416 2 2.18128 4.28566 2.00983 7.16851.8403 7.57763.0 8.68965.0 10c0 1.6571 1.34286 3 3 3H13c1.6571.0 3-1.3429 3-3 0-1.65714-1.3429-3-3-3L12.9776 7.00009C12.7249 4.19714 10.3686 2 7.5 2zM3.00107 7.48137 3.00008 7.47308C3.01457 5.0006 5.02412 3 7.5 3c2.47599.0 4.4856 2.00079 4.4999 4.47342L11.9987 7.4836C11.9969 7.50027 11.995 7.52348 11.995 7.551 11.995 7.701 12.0623 7.84308 12.1785 7.93804 12.2946 8.03301 12.4472 8.07082 12.5942 8.04106 12.726 8.01438 12.8617 8 13 8c1.1049.0 2 .89514 2 2C15 11.1049 14.1049 12 13 12H3C1.89514 12 1 11.1049 1 10 1 9.03225 1.68901 8.22422 2.60364 8.04017 2.83708 7.9932 3.005 7.78812 3.005 7.55 3.005 7.52154 3.00291 7.49773 3.00107 7.48137z"/></g></svg>
Cloud</a></div></li><li class=menu-mobile__item data-path=menu-2><div class=menu-mobile__item-content><a class=active href=https://qdrant.tech/documentation/build/><svg width="16" height="16" viewBox="0 0 16 16" fill="#e1e5f0"><g id="Menu/Blog"><path id="Union" fill-rule="evenodd" clip-rule="evenodd" d="M0 1.5C0 1.22386.223858 1 .5 1h5c.27614.0.5.22386.5.5v5c0 .27614-.22386.5-.5.5H.5C.223858 7 0 6.77614.0 6.5v-5zM1 2V6H5V2H1zm7 .5c0-.27614.22386-.5.5-.5h7c.2761.0.5.22386.5.5s-.2239.5-.5.5h-7C8.22386 3 8 2.77614 8 2.5zM8.5 6c-.27614.0-.5.22386-.5.5s.22386.5.5.5h7c.2761.0.5-.22386.5-.5s-.2239-.5-.5-.5h-7zM0 10.5c0-.2761.223858-.5.5-.5h15c.2761.0.5.2239.5.5s-.2239.5-.5.5H.5c-.276142.0-.5-.2239-.5-.5zM.5 14c-.276142.0-.5.2239-.5.5s.223858.5.5.5h15c.2761.0.5-.2239.5-.5s-.2239-.5-.5-.5H.5z"/></g></svg>
Build</a></div></li><li class=menu-mobile__item data-path=menu-3><div class=menu-mobile__item-content><a href=https://qdrant.tech/articles/><svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="#e1e5f0"><g id="Group"><path id="Vector" d="M10.084 1.84094l4.059 4.059" stroke-linecap="round" stroke-linejoin="round"/><path id="Vector_2" d="M8.49188 2.72406c-1.22044-.53042-2.59304-.59475-3.85774-.1808-1.2647.41395-2.33363 1.27742-3.00426 2.4268l2.34 2.34" stroke-linecap="round" stroke-linejoin="round"/><path id="Vector_3" d="M13.2657 7.47302C13.8062 8.69691 13.8769 10.077 13.4645 11.3497c-.4125 1.2728-1.2792 2.3491-2.4348 3.0233l-2.35001-2.35" stroke-linecap="round" stroke-linejoin="round"/><path id="Vector_4" d="M6.81217 13.049l-3.861-3.861S6.24917.983 15.5002.5c-.523 9.211-8.68803 12.549-8.68803 12.549z" stroke-linecap="round" stroke-linejoin="round"/><path id="Vector_5" d="M3.59892 12.4008C3.34181 12.1441 2.99331 12 2.62995 12c-.36335.0-.71186.1441-.96897.4008-.46665.4664-.63131 1.941-.65931 2.2322C.997021 14.6793 1.0021 14.726 1.01659 14.7701 1.03108 14.8143 1.05465 14.8549 1.08579 14.8895 1.11693 14.924 1.15495 14.9516 1.19741 14.9705 1.23987 14.9895 1.28583 14.9994 1.33233 14.9995 1.34298 15.0002 1.35367 15.0002 1.36433 14.9995 1.65565 14.9715 3.1316 14.8063 3.59759 14.3405 3.85501 14.0834 3.99975 13.7346 4 13.3709 4.00025 13.0072 3.85599 12.6582 3.59892 12.4008z" stroke-linecap="round" stroke-linejoin="round"/><path id="Vector_6" d="M9 8c.55228.0 1-.44772 1-1S9.55228 6 9 6 8 6.44772 8 7s.44772 1 1 1z"/></g></svg>
Learn</a></div></li><li class=menu-mobile__item data-path=menu-4><div class=menu-mobile__item-content><a href=https://api.qdrant.tech/api-reference target=_blank><svg width="16" height="16" viewBox="0 0 16 16" fill="#e1e5f0"><g id="Menu/Roadmap" clip-path="url(#clip0_7182_4311)"><path id="Vector" fill-rule="evenodd" clip-rule="evenodd" d="M13.5 1c-.8284.0-1.5.67157-1.5 1.5S12.6716 4 13.5 4 15 3.32843 15 2.5 14.3284 1 13.5 1zM11 2.5C11 1.11929 12.1193.0 13.5.0S16 1.11929 16 2.5 14.8807 5 13.5 5 11 3.88071 11 2.5zM2.5 12c-.82843.0-1.5.6716-1.5 1.5S1.67157 15 2.5 15 4 14.3284 4 13.5 3.32843 12 2.5 12zM0 13.5C0 12.1193 1.11929 11 2.5 11S5 12.1193 5 13.5 3.88071 16 2.5 16 0 14.8807.0 13.5zM3.65901 1.65901C4.08097 1.23705 4.65326 1 5.25 1s1.16903.23705 1.59099.65901C7.26295 2.08097 7.5 2.65326 7.5 3.25v9.5c0 .862.34241 1.6886.9519 2.2981C9.0614 15.6576 9.88805 16 10.75 16c.862.0 1.6886-.3424 2.2981-.9519S14 13.612 14 12.75V6.5c0-.27614-.2239-.5-.5-.5s-.5.22386-.5.5v6.25C13 13.3467 12.7629 13.919 12.341 14.341 11.919 14.7629 11.3467 15 10.75 15S9.58097 14.7629 9.15901 14.341C8.73705 13.919 8.5 13.3467 8.5 12.75V3.25C8.5 2.38805 8.15759 1.5614 7.5481.951903 6.9386.34241 6.11195.0 5.25.0S3.5614.34241 2.9519.951903C2.34241 1.5614 2 2.38805 2 3.25V9.5c0 .27614.22386.5.5.5s.5-.22386.5-.5V3.25c0-.59674.23705-1.16903.65901-1.59099z"/></g><defs><clipPath id="clip0_7182_4311"><rect width="16" height="16" fill="#fff"/></clipPath></defs></svg>
API Reference</a></div></li></ul><div class=docs-menu><div id=sidebar class=docs-menu__content><nav class=docs-menu__links><h3 class=docs-menu__links-title>Essentials</h3><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/data-ingestion-beginners/>Data Ingestion for Beginners</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/agentic-rag-crewai-zoom/>Simple Agentic RAG System</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/agentic-rag-langgraph/>Agentic RAG With LangGraph</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/agentic-rag-camelai-discord/>Agentic RAG Discord Bot with CAMEL-AI</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/multimodal-search/>Multilingual & Multimodal RAG with LlamaIndex</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/rag-deepseek/>5 Minute RAG with Qdrant and DeepSeek</a></div></div><h3 class=docs-menu__links-title>Integrations</h3><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/data-management/>Data Management</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/airbyte/>Airbyte</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/airflow/>Apache Airflow</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/nifi/>Apache NiFi</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/spark/>Apache Spark</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/cocoindex/>CocoIndex</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/cognee/>cognee</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/confluent/>Confluent Kafka</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/dlt/>DLT</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/fondant/>Fondant</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/fluvio/>InfinyOn Fluvio</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/mindsdb/>MindsDB</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/redpanda/>Redpanda Connect</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/unstructured/>Unstructured</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/embeddings/>Embeddings</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/aleph-alpha/>Aleph Alpha</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/bedrock/>AWS Bedrock</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/cohere/>Cohere</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/gemini/>Gemini</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/jina-embeddings/>Jina Embeddings</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/mistral/>Mistral</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/mixedbread/>MixedBread</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/mixpeek/>Mixpeek</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/nomic/>Nomic</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/nvidia/>Nvidia</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/ollama/>Ollama</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/openai/>OpenAI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/premai/>Prem AI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/snowflake/>Snowflake Models</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/twelvelabs/>Twelve Labs</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/upstage/>Upstage</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/voyage/>Voyage AI</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/frameworks/>Frameworks</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/autogen/>Autogen</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/lakechain/>AWS Lakechain</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/camel/>CamelAI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/cheshire-cat/>Cheshire Cat</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/crewai/>CrewAI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/dagster/>Dagster</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/deepeval/>DeepEval</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/docarray/>DocArray</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/dsrag/>dsRAG</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/dynamiq/>Dynamiq</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/feast/>Feast</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/fifty-one/>FiftyOne</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/genkit/>Firebase Genkit</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/haystack/>Haystack</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/honeyhive/>HoneyHive</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/langchain/>Langchain</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/langchain-go/>Langchain Go</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/langchain4j/>Langchain4J</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/langgraph/>LangGraph</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/llama-index/>LlamaIndex</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/mastra/>Mastra</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/mem0/>Mem0</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/nlweb/>Microsoft NLWeb</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/neo4j-graphrag/>Neo4j GraphRAG</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/openai-agents/>OpenAI Agents</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/pandas-ai/>Pandas-AI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/canopy/>Pinecone Canopy</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/ragbits/>Ragbits</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/rig-rs/>Rig-rs</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/semantic-router/>Semantic-Router</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/smolagents/>SmolAgents</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/solon/>Solon</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/spring-ai/>Spring AI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/dspy/>Stanford DSPy</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/superduper/>Superduper</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/sycamore/>Sycamore</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/testcontainers/>Testcontainers</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/txtai/>txtai</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/vanna-ai/>Vanna.AI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/mirror-security/>VectaX - Mirror Security</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/observability/>Observability</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/observability/openllmetry/>OpenLLMetry</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/observability/openlit/>OpenLIT</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/observability/datadog/>Datadog</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/platforms/>Platforms</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/apify/>Apify</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/bubble/>Bubble</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/buildship/>BuildShip</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/docsgpt/>DocsGPT</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/rivet/>Ironclad Rivet</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/keboola/>Keboola</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/kotaemon/>Kotaemon</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/make/>Make.com</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/n8n/>N8N</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/pipedream/>Pipedream</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/portable/>Portable.io</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/powerapps/>Power Apps</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/privategpt/>PrivateGPT</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/mulesoft/>Salesforce Mulesoft</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/tooljet/>ToolJet</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/vectorize/>Vectorize.io</a></li></ul></nav></details><h3 class=docs-menu__links-title>Examples</h3><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/search-precision/reranking-semantic-search/>Search Enhancement</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/search-precision/reranking-semantic-search/>Reranking in Semantic Search</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/search-precision/automate-filtering-with-llms/>Automate filtering with LLMs</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/send-data/>Send Data to Qdrant</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/send-data/databricks/>Qdrant on Databricks</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/send-data/qdrant-airflow-astronomer/>Semantic Querying with Airflow and Astronomer</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/send-data/data-streaming-kafka-qdrant/>How to Setup Seamless Data Streaming with Kafka and Qdrant</a></li></ul></nav></details><details class="docs-menu__links-group link-group active" open><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/examples/>Build Prototypes</a></summary><nav><ul class=docs-menu__links-submenu><li class="docs-menu__links-submenu-item
active"><a href=https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/>GraphRAG with Qdrant and Neo4j</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/llama-index-multitenancy/>Multitenancy with LlamaIndex</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-chatbot-red-hat-openshift-haystack/>Private Chatbot for Interactive Learning</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/cohere-rag-connector/>Implement Cohere RAG connector</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-customer-support-cohere-airbyte-aws/>Question-Answering System for AI Customer Support</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/hybrid-search-llamaindex-jinaai/>Chat With Product PDF Manuals Using Hybrid Search</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-contract-management-stackit-aleph-alpha/>Region-Specific Contract Management System</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/natural-language-search-oracle-cloud-infrastructure-cohere-langchain/>RAG System for Employee Onboarding</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-chatbot-vultr-dspy-ollama/>Private RAG Information Extraction Engine</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/recommendation-system-ovhcloud/>Movie Recommendation System</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-chatbot-scaleway/>Blog-Reading Chatbot with GPT-4o</a></li></ul></nav></details><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/datasets/>Practice Datasets</a></div></div></nav></div></div></div></header><section class="docs documentation"><div class=documentation__container><div class="d-flex flex-column flex-xl-row"><div class=docs-menu><div id=sidebar class=docs-menu__content><nav class=docs-menu__links><h3 class=docs-menu__links-title>Essentials</h3><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/data-ingestion-beginners/>Data Ingestion for Beginners</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/agentic-rag-crewai-zoom/>Simple Agentic RAG System</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/agentic-rag-langgraph/>Agentic RAG With LangGraph</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/agentic-rag-camelai-discord/>Agentic RAG Discord Bot with CAMEL-AI</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/multimodal-search/>Multilingual & Multimodal RAG with LlamaIndex</a></div></div><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/rag-deepseek/>5 Minute RAG with Qdrant and DeepSeek</a></div></div><h3 class=docs-menu__links-title>Integrations</h3><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/data-management/>Data Management</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/airbyte/>Airbyte</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/airflow/>Apache Airflow</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/nifi/>Apache NiFi</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/spark/>Apache Spark</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/cocoindex/>CocoIndex</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/cognee/>cognee</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/confluent/>Confluent Kafka</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/dlt/>DLT</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/fondant/>Fondant</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/fluvio/>InfinyOn Fluvio</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/mindsdb/>MindsDB</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/redpanda/>Redpanda Connect</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/data-management/unstructured/>Unstructured</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/embeddings/>Embeddings</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/aleph-alpha/>Aleph Alpha</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/bedrock/>AWS Bedrock</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/cohere/>Cohere</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/gemini/>Gemini</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/jina-embeddings/>Jina Embeddings</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/mistral/>Mistral</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/mixedbread/>MixedBread</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/mixpeek/>Mixpeek</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/nomic/>Nomic</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/nvidia/>Nvidia</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/ollama/>Ollama</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/openai/>OpenAI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/premai/>Prem AI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/snowflake/>Snowflake Models</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/twelvelabs/>Twelve Labs</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/upstage/>Upstage</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/embeddings/voyage/>Voyage AI</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/frameworks/>Frameworks</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/autogen/>Autogen</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/lakechain/>AWS Lakechain</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/camel/>CamelAI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/cheshire-cat/>Cheshire Cat</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/crewai/>CrewAI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/dagster/>Dagster</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/deepeval/>DeepEval</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/docarray/>DocArray</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/dsrag/>dsRAG</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/dynamiq/>Dynamiq</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/feast/>Feast</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/fifty-one/>FiftyOne</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/genkit/>Firebase Genkit</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/haystack/>Haystack</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/honeyhive/>HoneyHive</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/langchain/>Langchain</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/langchain-go/>Langchain Go</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/langchain4j/>Langchain4J</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/langgraph/>LangGraph</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/llama-index/>LlamaIndex</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/mastra/>Mastra</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/mem0/>Mem0</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/nlweb/>Microsoft NLWeb</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/neo4j-graphrag/>Neo4j GraphRAG</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/openai-agents/>OpenAI Agents</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/pandas-ai/>Pandas-AI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/canopy/>Pinecone Canopy</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/ragbits/>Ragbits</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/rig-rs/>Rig-rs</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/semantic-router/>Semantic-Router</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/smolagents/>SmolAgents</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/solon/>Solon</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/spring-ai/>Spring AI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/dspy/>Stanford DSPy</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/superduper/>Superduper</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/sycamore/>Sycamore</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/testcontainers/>Testcontainers</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/txtai/>txtai</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/vanna-ai/>Vanna.AI</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/frameworks/mirror-security/>VectaX - Mirror Security</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/observability/>Observability</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/observability/openllmetry/>OpenLLMetry</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/observability/openlit/>OpenLIT</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/observability/datadog/>Datadog</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/platforms/>Platforms</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/apify/>Apify</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/bubble/>Bubble</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/buildship/>BuildShip</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/docsgpt/>DocsGPT</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/rivet/>Ironclad Rivet</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/keboola/>Keboola</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/kotaemon/>Kotaemon</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/make/>Make.com</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/n8n/>N8N</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/pipedream/>Pipedream</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/portable/>Portable.io</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/powerapps/>Power Apps</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/privategpt/>PrivateGPT</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/mulesoft/>Salesforce Mulesoft</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/tooljet/>ToolJet</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/platforms/vectorize/>Vectorize.io</a></li></ul></nav></details><h3 class=docs-menu__links-title>Examples</h3><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/search-precision/reranking-semantic-search/>Search Enhancement</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/search-precision/reranking-semantic-search/>Reranking in Semantic Search</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/search-precision/automate-filtering-with-llms/>Automate filtering with LLMs</a></li></ul></nav></details><details class="docs-menu__links-group link-group"><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/send-data/>Send Data to Qdrant</a></summary><nav><ul class=docs-menu__links-submenu><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/send-data/databricks/>Qdrant on Databricks</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/send-data/qdrant-airflow-astronomer/>Semantic Querying with Airflow and Astronomer</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/send-data/data-streaming-kafka-qdrant/>How to Setup Seamless Data Streaming with Kafka and Qdrant</a></li></ul></nav></details><details class="docs-menu__links-group link-group active" open><summary class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/examples/>Build Prototypes</a></summary><nav><ul class=docs-menu__links-submenu><li class="docs-menu__links-submenu-item
active"><a href=https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/>GraphRAG with Qdrant and Neo4j</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/llama-index-multitenancy/>Multitenancy with LlamaIndex</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-chatbot-red-hat-openshift-haystack/>Private Chatbot for Interactive Learning</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/cohere-rag-connector/>Implement Cohere RAG connector</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-customer-support-cohere-airbyte-aws/>Question-Answering System for AI Customer Support</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/hybrid-search-llamaindex-jinaai/>Chat With Product PDF Manuals Using Hybrid Search</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-contract-management-stackit-aleph-alpha/>Region-Specific Contract Management System</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/natural-language-search-oracle-cloud-infrastructure-cohere-langchain/>RAG System for Employee Onboarding</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-chatbot-vultr-dspy-ollama/>Private RAG Information Extraction Engine</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/recommendation-system-ovhcloud/>Movie Recommendation System</a></li><li class=docs-menu__links-submenu-item><a href=https://qdrant.tech/documentation/examples/rag-chatbot-scaleway/>Blog-Reading Chatbot with GPT-4o</a></li></ul></nav></details><div class=docs-menu__links-group><div class=docs-menu__links-group-heading><a href=https://qdrant.tech/documentation/datasets/>Practice Datasets</a></div></div></nav></div></div><div class=documentation__content><div class=documentation__content-wrapper><div class=documentation__article-wrapper><ul class=docs-breadcrumbs><li class=docs-breadcrumbs__crumb><a href=https://qdrant.tech/documentation/>Documentation</a></li><li class=docs-breadcrumbs__crumb-separator></li><li class=docs-breadcrumbs__crumb><a href=https://qdrant.tech/documentation/examples/>Examples</a></li><li class=docs-breadcrumbs__crumb-separator></li><li class=docs-breadcrumbs__crumb>GraphRAG with Qdrant and Neo4j</li></ul><article class=documentation-article><h1 id=build-a-graphrag-agent-with-neo4j-and-qdrant>Build a GraphRAG Agent with Neo4j and Qdrant</h1><p><img src=https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/image0.png alt=image0></p><div class=table-responsive><table class="table mb-5"><thead><tr><th>Time: 30 min</th><th>Level: Intermediate</th><th>Output: <a href=https://github.com/qdrant/examples/blob/master/graphrag_neo4j/graphrag.py target=_blank rel="noopener nofollow">GitHub</a></th></tr></thead><tbody></tbody></table></div><p>To make Artificial Intelligence (AI) systems more intelligent and reliable, we face a paradox: Large Language Models (LLMs) possess remarkable reasoning capabilities, yet they struggle to connect information in ways humans find intuitive. While groundbreaking, Retrieval-Augmented Generation (RAG) approaches often fall short when tasked with complex information synthesis. When asked to connect disparate pieces of information or understand holistic concepts across large documents, these systems frequently miss crucial connections that would be obvious to human experts.</p><p>To solve these problems, Microsoft introduced <strong>GraphRAG,</strong> which uses Knowledge Graphs (KGs) instead of vectors as a context for LLMs. GraphRAG depends mainly on LLMs for creating KGs and querying them. However, this reliance on LLMs can lead to many problems. We will address these challenges by combining vector databases with graph-based databases.</p><p>This tutorial will demonstrate how to build a GraphRAG system with vector search using Neo4j and Qdrant.</p><div class=table-responsive><table class="table mb-5"><thead><tr><th>Additional Materials</th></tr></thead><tbody><tr><td>This advanced tutorial is based on our original integration doc: <a href=https://qdrant.tech/documentation/frameworks/neo4j-graphrag/><strong>Neo4j - Qdrant Integration</strong></a></td></tr><tr><td>The output for this tutorial is in our GitHub Examples repo: <a href=https://github.com/qdrant/examples/blob/master/graphrag_neo4j/graphrag.py target=_blank rel="noopener nofollow"><strong>Neo4j - Qdrant Agent in Python</strong></a></td></tr></tbody></table></div><h2 id=watch-the-video>Watch the Video</h2><p align=center><iframe width=560 height=315 src="https://www.youtube.com/embed/o9pszzRuyjo?si=P-AfKB0tZ9Csph5C" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe></p><h1 id=rag--its-challenges>RAG & Its Challenges</h1><p><a href=https://qdrant.tech/rag/ target=_blank rel="noopener nofollow">RAG</a> combines retrieval-based and generative AI to enhance LLMs with relevant, up-to-date information from a knowledge base, like a vector database. However, RAG faces several challenges:</p><ol><li><strong>Understanding Context:</strong> Models may misinterpret queries, particularly when the context is complex or ambiguous, leading to incorrect or irrelevant answers.</li><li><strong>Balancing Similarity vs. Relevance:</strong> RAG systems can struggle to ensure that retrieved information is similar and contextually relevant.</li><li><strong>Answer Completeness:</strong> Traditional RAGs might not be able to capture all relevant details for complex queries that require LLMs to find relationships in the context that are not explicitly present.</li></ol><h1 id=introduction-to-graphrag>Introduction to GraphRAG</h1><p>Unlike RAG, which typically relies on document retrieval, GraphRAG builds knowledge graphs (KGs) to capture entities and their relationships. For datasets or use cases that demand human-level intelligence from an AI system, GraphRAG offers a promising solution:</p><ul><li>It can follow chains of relationships to answer complex queries, making it suitable for better reasoning beyond simple document retrieval.</li><li>The graph structure allows a deeper understanding of the context, leading to more accurate and relevant responses.</li></ul><p>The workflow of GraphRAG is as follows:</p><ol><li>The LLM analyzes the dataset to identify entities (people, places, organizations) and their relationships, creating a comprehensive knowledge graph where entities are nodes and their connections form edges.</li><li>A bottom-up clustering algorithm organizes the KG into hierarchical semantic groups. This creates meaningful segments of related information, enabling understanding at different levels of abstraction.</li><li>GraphRAG uses both the KG and semantic clusters to select a relevant context for the LLM when answering queries.</li></ol><p><img src=https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/image2.png alt=image2></p><p><a href=https://arxiv.org/pdf/2404.16130 target=_blank rel="noopener nofollow">Fig</a> 1: A Complete Picture of GraphRAG Ingestion and Retrieval</p><h3 id=challenges-of-graphrag>Challenges of GraphRAG</h3><p>Despite its advantages, the LLM-centric GraphRAG approach faces several challenges:</p><ul><li><strong>KG Construction with LLMs:</strong> Since the LLM is responsible for constructing the knowledge graph, there are risks such as inconsistencies, propagation of biases or errors, and lack of control over the ontology used. However, we used a LLM to extract the ontology in our implementation.</li><li><strong>Querying KG with LLMs:</strong> Once the graph is constructed, an LLM translates the human query into Cypher (Neo4j&rsquo;s declarative query language). However, crafting complex queries in Cypher may result in inaccurate outcomes.</li><li><strong>Scalability & Cost Consideration:</strong> To be practical, applications must be both scalable and cost-effective. Relying on LLMs increases costs and decreases scalability, as they are used every time data is added, queried, or generated.</li></ul><p>To address these challenges, a more controlled and structured knowledge representation system may be required for GraphRAG to function optimally at scale.</p><h1 id=architecture-overview>Architecture Overview</h1><p>The architecture has two main components: <strong>Ingestion</strong> and <strong>Retrieval & Generation</strong>. Ingestion processes raw data into structured knowledge and vector representations, while Retrieval and Generation enable efficient querying and response generation.</p><p>This process is divided into two steps: <strong>Ingestion</strong>, where data is prepared and stored, and <strong>Retrieval and Generation</strong>, where the prepared data is queried and utilized. Let‚Äôs start with Ingestion.</p><h2 id=ingestion>Ingestion</h2><p>The GraphRAG ingestion pipeline combines a <strong>Graph Database</strong> and a <strong>Vector Database</strong> to improve RAG workflows.</p><p><img src=https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/image1.png alt=image1></p><p>Fig 2: Overview of Ingestion Pipeline</p><p>Let‚Äôs break it down:</p><ol><li><strong>Raw Data:</strong> Serves as the foundation, comprising unstructured or structured content.</li><li><strong>Ontology Creation:</strong> An <strong>LLM</strong> processes the raw data into an <strong>ontology</strong>, structuring entities, relationships, and hierarchies. Better approaches exist to extracting more structured information from raw data, like using NER to identify the names of people, organizations, and places. Unlike LLMs, this method creates.</li><li><strong>Graph Database:</strong> The ontology is stored in a <strong>Graph database</strong> to capture complex relationships.</li><li><strong>Vector Embeddings:</strong> An <strong>Embedding model</strong> converts the raw data into high-dimensional vectors capturing semantic similarities.</li><li><strong>Vector Database:</strong> These embeddings are stored in a <strong>Vector database</strong> for similarity-based retrieval.</li><li><strong>Database Interlinking:</strong> The <strong>Graph database</strong> (e.g., Neo4j) and <strong>Vector database</strong> (e.g., Qdrant) share unique IDs, enabling cross-referencing between ontology-based and vector-based results.</li></ol><h2 id=retrieval--generation>Retrieval & Generation</h2><p>The <strong>Retrieval and Generation</strong> process is designed to handle user queries by leveraging both semantic search and graph-based context extraction.</p><p><img src=https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/image3.png alt=image3></p><p>Fig 3: Overview of Retrieval and Generation Pipeline</p><p>The architecture can be broken down into the following steps:</p><ol><li><strong>Query Vectorization:</strong> An embedding model converts The user query into a high-dimensional vector.</li><li><strong>Semantic Search:</strong> The vector performs a similarity-based search in the <strong>Vector database</strong>, retrieving relevant documents or entries.</li><li><strong>ID Extraction:</strong> Extracted IDs from the semantic search results are used to query the <strong>Graph database</strong>.</li><li><strong>Graph Context Retrieval:</strong> The <strong>Graph database</strong> provides contextual information, including relationships and entities linked to the extracted IDs.</li><li><strong>Response Generation:</strong> The context retrieved from the graph is passed to an LLM to generate a final response.</li><li><strong>Results:</strong> The generated response is returned to the user.</li></ol><p>This architecture combines the strengths of both databases:</p><ol><li><strong>Semantic Search with Vector Database:</strong> The user query is first processed semantically to identify the most relevant data points without needing explicit keyword matches.</li><li><strong>Contextual Expansion with Graph Database:</strong> IDs or entities retrieved from the vector database query the graph database for detailed relationships, enriching the retrieved data with structured context.</li><li><strong>Enhanced Generation:</strong> The architecture combines semantic relevance (from the vector database) and graph-based context to enable the LLM to generate more informed, accurate, and contextually rich responses.</li></ol><h1 id=implementation>Implementation</h1><p>We&rsquo;ll walk through a complete pipeline that ingests data into Neo4j and Qdrant, retrieves relevant data, and generates responses using an LLM based on the retrieved graph context.</p><p>The main components of this pipeline include data ingestion (to Neo4j and Qdrant), retrieval, and generation steps.</p><h2 id=prerequisites>Prerequisites</h2><p>These are the tutorial prerequisites, which are divided into setup, imports, and initialization of the two DBs.</p><h3 id=setup>Setup</h3><p>Let‚Äôs start with setting up instances with Qdrant and Neo4j.</p><h3 id=qdrant-setup>Qdrant Setup</h3><p>To create a Qdrant instance, you can use their <strong>managed service</strong> (Qdrant Cloud) or set up a self-hosted cluster. For simplicity, we will use Qdrant cloud:</p><ul><li>Go to <a href=https://qdrant.tech/ target=_blank rel="noopener nofollow">Qdrant Cloud</a> and sign up or log in.</li><li>Once logged in, click on <strong>Create New Cluster</strong>.</li><li>Follow the on-screen instructions to create your cluster.</li><li>Once your cluster is created, you&rsquo;ll be given a <strong>Cluster URL</strong> and <strong>API Key</strong>, which you will use in the client to interact with Qdrant.</li></ul><h3 id=neo4j-setup>Neo4j Setup</h3><p>To set up a Neo4j instance, you can use <strong>Neo4j Aura</strong> (cloud service) or host it yourself. We will use Neo4j Aura:</p><ul><li>Go to Neo4j Aura and sign up/log in.</li><li>After setting up, an instance will be created if it is the first time.</li><li>After the database is set up, you‚Äôll receive a <strong>connection URI</strong>, <strong>username</strong>, and <strong>password</strong>.</li></ul><p>We can add the following in the .env file for security purposes.</p><h3 id=imports>Imports</h3><p>First, we import the required libraries for working with Neo4j, Qdrant, OpenAI, and other utility functions.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>neo4j</span> <span class=kn>import</span> <span class=n>GraphDatabase</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>qdrant_client</span> <span class=kn>import</span> <span class=n>QdrantClient</span><span class=p>,</span> <span class=n>models</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dotenv</span> <span class=kn>import</span> <span class=n>load_dotenv</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pydantic</span> <span class=kn>import</span> <span class=n>BaseModel</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>openai</span> <span class=kn>import</span> <span class=n>OpenAI</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>neo4j_graphrag.retrievers</span> <span class=kn>import</span> <span class=n>QdrantNeo4jRetriever</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>uuid</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span></code></pre></div><hr><ul><li><strong>Neo4j:</strong> Used to store and query the graph database.</li><li><strong>Qdrant:</strong> A vector database used for semantic similarity search.</li><li><strong>dotenv:</strong> Loads environment variables for credentials and API keys.</li><li><strong>Pydantic:</strong> Ensures data is structured properly when interacting with the graph data.</li><li><strong>OpenAI:</strong> Interfaces with the OpenAI API to generate responses and embeddings.</li><li><strong>neo4j_graphrag:</strong> A helper package to retrieve data from both Qdrant and Neo4j.</li></ul><h3 id=setting-up-environment-variables>Setting Up Environment Variables</h3><p>Before initializing the clients, we load the necessary credentials from environment variables.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Load environment variables</span>
</span></span><span class=line><span class=cl><span class=n>load_dotenv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get credentials from environment variables</span>
</span></span><span class=line><span class=cl><span class=n>qdrant_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;QDRANT_KEY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>qdrant_url</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;QDRANT_URL&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>neo4j_uri</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;NEO4J_URI&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>neo4j_username</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;NEO4J_USERNAME&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>neo4j_password</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;NEO4J_PASSWORD&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>openai_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;OPENAI_API_KEY&#34;</span><span class=p>)</span>
</span></span></code></pre></div><hr><p>This ensures that sensitive information (like API keys and database credentials) is securely stored in environment variables.</p><h3 id=initializing-neo4j-and-qdrant-clients>Initializing Neo4j and Qdrant Clients</h3><p>Now, we initialize the Neo4j and Qdrant clients using the credentials.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Initialize Neo4j driver</span>
</span></span><span class=line><span class=cl><span class=n>neo4j_driver</span> <span class=o>=</span> <span class=n>GraphDatabase</span><span class=o>.</span><span class=n>driver</span><span class=p>(</span><span class=n>neo4j_uri</span><span class=p>,</span> <span class=n>auth</span><span class=o>=</span><span class=p>(</span><span class=n>neo4j_username</span><span class=p>,</span> <span class=n>neo4j_password</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initialize Qdrant client</span>
</span></span><span class=line><span class=cl><span class=n>qdrant_client</span> <span class=o>=</span> <span class=n>QdrantClient</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span><span class=o>=</span><span class=n>qdrant_url</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>api_key</span><span class=o>=</span><span class=n>qdrant_key</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><hr><ul><li><strong>Neo4j:</strong> We set up a connection to the Neo4j graph database.</li><li><strong>Qdrant:</strong> We initialize the connection to the Qdrant vector store.</li></ul><p>This will connect with Neo4j and Qdrant, and we can now start with Ingestion.</p><h2 id=ingestion-1>Ingestion</h2><p>We will follow the workflow of the ingestion pipeline presented in the architecture section. Let‚Äôs examine it implementation-wise.</p><h3 id=defining-output-parser>Defining Output Parser</h3><p>The single and GraphComponents classes structure the LLM&rsquo;s responses into a usable format.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>single</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>node</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>target_node</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>relationship</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>GraphComponents</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>graph</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>single</span><span class=p>]</span>
</span></span></code></pre></div><hr><p>These classes help ensure that data from the OpenAI LLM is parsed correctly into the graph components (nodes and relationships).</p><h3 id=defining-openai-client-and-llm-parser-function>Defining OpenAI Client and LLM Parser Function</h3><p>We now initialize the OpenAI client and define a function to send prompts to the LLM and parse its responses.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>client</span> <span class=o>=</span> <span class=n>OpenAI</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>openai_llm_parser</span><span class=p>(</span><span class=n>prompt</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>completion</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>chat</span><span class=o>.</span><span class=n>completions</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=s2>&#34;gpt-4o-2024-08-06&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>response_format</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;json_object&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;content&#34;</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>                   
</span></span><span class=line><span class=cl>                <span class=s2>&#34;&#34;&#34; You are a precise graph relationship extractor. Extract all 
</span></span></span><span class=line><span class=cl><span class=s2>                    relationships from the text and format them as a JSON object 
</span></span></span><span class=line><span class=cl><span class=s2>                    with this exact structure:
</span></span></span><span class=line><span class=cl><span class=s2>                    {
</span></span></span><span class=line><span class=cl><span class=s2>                        &#34;graph&#34;: [
</span></span></span><span class=line><span class=cl><span class=s2>                            {&#34;node&#34;: &#34;Person/Entity&#34;, 
</span></span></span><span class=line><span class=cl><span class=s2>                             &#34;target_node&#34;: &#34;Related Entity&#34;, 
</span></span></span><span class=line><span class=cl><span class=s2>                             &#34;relationship&#34;: &#34;Type of Relationship&#34;},
</span></span></span><span class=line><span class=cl><span class=s2>                            ...more relationships...
</span></span></span><span class=line><span class=cl><span class=s2>                        ]
</span></span></span><span class=line><span class=cl><span class=s2>                    }
</span></span></span><span class=line><span class=cl><span class=s2>                    Include ALL relationships mentioned in the text, including 
</span></span></span><span class=line><span class=cl><span class=s2>                    implicit ones. Be thorough and precise. &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>prompt</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>GraphComponents</span><span class=o>.</span><span class=n>model_validate_json</span><span class=p>(</span><span class=n>completion</span><span class=o>.</span><span class=n>choices</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>message</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span></code></pre></div><hr><p>This function sends a prompt to the LLM, asking it to extract graph components (nodes and relationships) from the provided text. The response is parsed into structured graph data.</p><h3 id=extracting-graph-components>Extracting Graph Components</h3><p>The function extract_graph_components processes raw data, extracting the nodes and relationships as graph components.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_graph_components</span><span class=p>(</span><span class=n>raw_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>prompt</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;Extract nodes and relationships from the following text:</span><span class=se>\n</span><span class=si>{</span><span class=n>raw_data</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>parsed_response</span> <span class=o>=</span> <span class=n>openai_llm_parser</span><span class=p>(</span><span class=n>prompt</span><span class=p>)</span>  <span class=c1># Assuming this returns a list of dictionaries</span>
</span></span><span class=line><span class=cl>    <span class=n>parsed_response</span> <span class=o>=</span> <span class=n>parsed_response</span><span class=o>.</span><span class=n>graph</span>  <span class=c1># Assuming the &#39;graph&#39; structure is a key in the parsed response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>relationships</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>entry</span> <span class=ow>in</span> <span class=n>parsed_response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>node</span> <span class=o>=</span> <span class=n>entry</span><span class=o>.</span><span class=n>node</span>
</span></span><span class=line><span class=cl>        <span class=n>target_node</span> <span class=o>=</span> <span class=n>entry</span><span class=o>.</span><span class=n>target_node</span>  <span class=c1># Get target node if available</span>
</span></span><span class=line><span class=cl>        <span class=n>relationship</span> <span class=o>=</span> <span class=n>entry</span><span class=o>.</span><span class=n>relationship</span>  <span class=c1># Get relationship if available</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Add nodes to the dictionary with a unique ID</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>node</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>nodes</span><span class=p>[</span><span class=n>node</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>target_node</span> <span class=ow>and</span> <span class=n>target_node</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>nodes</span><span class=p>[</span><span class=n>target_node</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Add relationship to the relationships list with node IDs</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>target_node</span> <span class=ow>and</span> <span class=n>relationship</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>relationships</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;source&#34;</span><span class=p>:</span> <span class=n>nodes</span><span class=p>[</span><span class=n>node</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;target&#34;</span><span class=p>:</span> <span class=n>nodes</span><span class=p>[</span><span class=n>target_node</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=n>relationship</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>nodes</span><span class=p>,</span> <span class=n>relationships</span>
</span></span></code></pre></div><hr><p>This function takes raw data, uses the LLM to parse it into graph components, and then assigns unique IDs to nodes and relationships.</p><h3 id=ingesting-data-to-neo4j>Ingesting Data to Neo4j</h3><p>The function ingest_to_neo4j ingests the extracted graph data (nodes and relationships) into Neo4j.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>ingest_to_neo4j</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>relationships</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Ingest nodes and relationships into Neo4j.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>neo4j_driver</span><span class=o>.</span><span class=n>session</span><span class=p>()</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Create nodes in Neo4j</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>node_id</span> <span class=ow>in</span> <span class=n>nodes</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;CREATE (n:Entity {id: $id, name: $name})&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nb>id</span><span class=o>=</span><span class=n>node_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=n>name</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Create relationships in Neo4j</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>relationship</span> <span class=ow>in</span> <span class=n>relationships</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;MATCH (a:Entity {id: $source_id}), (b:Entity {id: $target_id}) &#34;</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;CREATE (a)-[:RELATIONSHIP {type: $type}]-&gt;(b)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>source_id</span><span class=o>=</span><span class=n>relationship</span><span class=p>[</span><span class=s2>&#34;source&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>target_id</span><span class=o>=</span><span class=n>relationship</span><span class=p>[</span><span class=s2>&#34;target&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nb>type</span><span class=o>=</span><span class=n>relationship</span><span class=p>[</span><span class=s2>&#34;type&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>nodes</span>
</span></span></code></pre></div><hr><p>Here, we create nodes and relationships in the Neo4j graph database. Nodes are entities, and relationships link these entities.</p><p>This will ingest the data into Neo4j and on a sample dataset it looks something like this:</p><p><img src=https://qdrant.tech/documentation/examples/graphrag-qdrant-neo4j/image4.png alt=image4></p><p>Fig 4: Visualization of the Knowledge Graph</p><p>Let&rsquo;s explore how to map nodes with their IDs and integrate this information, along with vectors, into Qdrant. First, let‚Äôs create a Qdrant collection.</p><h3 id=creating-qdrant-collection>Creating Qdrant Collection</h3><p>You can create a collection once you have set up your Qdrant instance. A collection in Qdrant holds vectors for search and retrieval.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_collection</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>collection_name</span><span class=p>,</span> <span class=n>vector_dimension</span><span class=p>):</span>
</span></span></code></pre></div><p>try:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Try to fetch the collection status</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>collection_info</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_collection</span><span class=p>(</span><span class=n>collection_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Skipping creating collection; &#39;</span><span class=si>{</span><span class=n>collection_name</span><span class=si>}</span><span class=s2>&#39; already exists.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># If collection does not exist, an error will be thrown, so we create the collection</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;Not found: Collection&#39;</span> <span class=ow>in</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Collection &#39;</span><span class=si>{</span><span class=n>collection_name</span><span class=si>}</span><span class=s2>&#39; not found. Creating it now...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>client</span><span class=o>.</span><span class=n>create_collection</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>collection_name</span><span class=o>=</span><span class=n>collection_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>vectors_config</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>VectorParams</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=n>vector_dimension</span><span class=p>,</span> <span class=n>distance</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>Distance</span><span class=o>.</span><span class=n>COSINE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Collection &#39;</span><span class=si>{</span><span class=n>collection_name</span><span class=si>}</span><span class=s2>&#39; created successfully.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error while checking collection: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><hr><ul><li><strong>Qdrant Client:</strong> The QdrantClient is used to connect to the Qdrant instance.</li><li><strong>Creating Collection:</strong> The create_collection function checks if a collection exists. If not, it creates one with a specified vector dimension and distance metric (cosine similarity in this case).</li></ul><h3 id=generating-embeddings>Generating Embeddings</h3><p>Next, we define a function that generates embeddings for text using OpenAI&rsquo;s API.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>openai_embeddings</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>embeddings</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nb>input</span><span class=o>=</span><span class=n>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=s2>&#34;text-embedding-3-small&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>embedding</span>
</span></span></code></pre></div><hr><p>This function uses OpenAI&rsquo;s embedding model to transform input text into vector representations.</p><h3 id=ingesting-into-qdrant>Ingesting into Qdrant</h3><p>Let‚Äôs ingest the data into the vector database.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>ingest_to_qdrant</span><span class=p>(</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>raw_data</span><span class=p>,</span> <span class=n>node_id_mapping</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>embeddings</span> <span class=o>=</span> <span class=p>[</span><span class=n>openai_embeddings</span><span class=p>(</span><span class=n>paragraph</span><span class=p>)</span> <span class=k>for</span> <span class=n>paragraph</span> <span class=ow>in</span> <span class=n>raw_data</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>qdrant_client</span><span class=o>.</span><span class=n>upsert</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>collection_name</span><span class=o>=</span><span class=n>collection_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>points</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;vector&#34;</span><span class=p>:</span> <span class=n>embedding</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payload&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>node_id</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>node_id</span><span class=p>,</span> <span class=n>embedding</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>node_id_mapping</span><span class=o>.</span><span class=n>values</span><span class=p>(),</span> <span class=n>embeddings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div><hr><p>The ingest_to_qdrant function generates embeddings for each paragraph in the raw data and stores them in a Qdrant collection. It associates each embedding with a unique ID and its corresponding node ID from the node_id_mapping dictionary, ensuring proper linkage for later retrieval.</p><hr><h2 id=retrieval--generation-1>Retrieval & Generation</h2><p>In this section, we will create the retrieval and generation engine for the system.</p><h3 id=building-a-retriever>Building a Retriever</h3><p>The retriever integrates vector search and graph data, enabling semantic similarity searches with Qdrant and fetching relevant graph data from Neo4j. This enriches the RAG process and allows for more informed responses.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>retriever_search</span><span class=p>(</span><span class=n>neo4j_driver</span><span class=p>,</span> <span class=n>qdrant_client</span><span class=p>,</span> <span class=n>collection_name</span><span class=p>,</span> <span class=n>query</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>retriever</span> <span class=o>=</span> <span class=n>QdrantNeo4jRetriever</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>driver</span><span class=o>=</span><span class=n>neo4j_driver</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>client</span><span class=o>=</span><span class=n>qdrant_client</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>collection_name</span><span class=o>=</span><span class=n>collection_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>id_property_external</span><span class=o>=</span><span class=s2>&#34;id&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>id_property_neo4j</span><span class=o>=</span><span class=s2>&#34;id&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=n>retriever</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>query_vector</span><span class=o>=</span><span class=n>openai_embeddings</span><span class=p>(</span><span class=n>query</span><span class=p>),</span> <span class=n>top_k</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>results</span>
</span></span></code></pre></div><hr><p>The <a href=https://qdrant.tech/documentation/frameworks/neo4j-graphrag/ target=_blank rel="noopener nofollow">QdrantNeo4jRetriever</a> handles both vector search and graph data fetching, combining Qdrant for vector-based retrieval and Neo4j for graph-based queries.</p><p><strong>Vector Search:</strong></p><ul><li><strong><code>qdrant_client</code></strong> connects to Qdrant for efficient vector similarity search.</li><li><strong><code>collection_name</code></strong> specifies where vectors are stored.</li><li><strong><code>id_property_external="id"</code></strong> maps the external entity‚Äôs ID for retrieval.</li></ul><p><strong>Graph Fetching:</strong></p><ul><li><strong><code>neo4j_driver</code></strong> connects to Neo4j for querying graph data.</li><li><strong><code>id_property_neo4j="id"</code></strong> ensures the entity IDs from Qdrant match the graph nodes in Neo4j.</li></ul><h3 id=querying-neo4j-for-related-graph-data>Querying Neo4j for Related Graph Data</h3><p>We need to fetch subgraph data from a Neo4j database based on specific entity IDs after the retriever has provided the relevant IDs.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_related_graph</span><span class=p>(</span><span class=n>neo4j_client</span><span class=p>,</span> <span class=n>entity_ids</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    MATCH (e:Entity)-[r1]-(n1)-[r2]-(n2)
</span></span></span><span class=line><span class=cl><span class=s2>    WHERE e.id IN $entity_ids
</span></span></span><span class=line><span class=cl><span class=s2>    RETURN e, r1 as r, n1 as related, r2, n2
</span></span></span><span class=line><span class=cl><span class=s2>    UNION
</span></span></span><span class=line><span class=cl><span class=s2>    MATCH (e:Entity)-[r]-(related)
</span></span></span><span class=line><span class=cl><span class=s2>    WHERE e.id IN $entity_ids
</span></span></span><span class=line><span class=cl><span class=s2>    RETURN e, r, related, null as r2, null as n2
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>neo4j_client</span><span class=o>.</span><span class=n>session</span><span class=p>()</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=n>entity_ids</span><span class=o>=</span><span class=n>entity_ids</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>subgraph</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>record</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>subgraph</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;entity&#34;</span><span class=p>:</span> <span class=n>record</span><span class=p>[</span><span class=s2>&#34;e&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;relationship&#34;</span><span class=p>:</span> <span class=n>record</span><span class=p>[</span><span class=s2>&#34;r&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;related_node&#34;</span><span class=p>:</span> <span class=n>record</span><span class=p>[</span><span class=s2>&#34;related&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>record</span><span class=p>[</span><span class=s2>&#34;r2&#34;</span><span class=p>]</span> <span class=ow>and</span> <span class=n>record</span><span class=p>[</span><span class=s2>&#34;n2&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>subgraph</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;entity&#34;</span><span class=p>:</span> <span class=n>record</span><span class=p>[</span><span class=s2>&#34;related&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;relationship&#34;</span><span class=p>:</span> <span class=n>record</span><span class=p>[</span><span class=s2>&#34;r2&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;related_node&#34;</span><span class=p>:</span> <span class=n>record</span><span class=p>[</span><span class=s2>&#34;n2&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>subgraph</span>
</span></span></code></pre></div><hr><p>The function fetch_related_graph takes in a Neo4j client and a list of entity_ids. It runs a Cypher query to find related nodes (entities) and their relationships based on the given entity IDs. The query matches entities (e:Entity) and finds related nodes through any relationship [r]. The function returns a list of subgraph data, where each record contains the entity, relationship, and related_node.</p><p>This subgraph is essential for generating context to answer user queries.</p><h3 id=setting-up-the-graph-context>Setting up the Graph Context</h3><p>The second part of the implementation involves preparing a graph context. We‚Äôll fetch relevant subgraph data from a Neo4j database and format it for the model. Let‚Äôs break it down.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>format_graph_context</span><span class=p>(</span><span class=n>subgraph</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>edges</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>entry</span> <span class=ow>in</span> <span class=n>subgraph</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>entity</span> <span class=o>=</span> <span class=n>entry</span><span class=p>[</span><span class=s2>&#34;entity&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>related</span> <span class=o>=</span> <span class=n>entry</span><span class=p>[</span><span class=s2>&#34;related_node&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>relationship</span> <span class=o>=</span> <span class=n>entry</span><span class=p>[</span><span class=s2>&#34;relationship&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>nodes</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>entity</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>nodes</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>related</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>edges</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>entity</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>relationship</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>related</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;nodes&#34;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=n>nodes</span><span class=p>),</span> <span class=s2>&#34;edges&#34;</span><span class=p>:</span> <span class=n>edges</span><span class=p>}</span>
</span></span></code></pre></div><hr><p>The function format_graph_context processes a subgraph returned by a Neo4j query. It extracts the graph&rsquo;s entities (nodes) and relationships (edges). The nodes set ensures each entity is added only once. The edges list captures the relationships in a readable format: <em>Entity1 relationship Entity2</em>.</p><h3 id=integrating-with-the-llm>Integrating with the LLM</h3><p>Now that we have the graph context, we need to generate a prompt for a language model like GPT-4. This is where the core of the Retrieval-Augmented Generation (RAG) happens ‚Äî we combine the graph data and the user query into a comprehensive prompt for the model.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>graphRAG_run</span><span class=p>(</span><span class=n>graph_context</span><span class=p>,</span> <span class=n>user_query</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>nodes_str</span> <span class=o>=</span> <span class=s2>&#34;, &#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>graph_context</span><span class=p>[</span><span class=s2>&#34;nodes&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>edges_str</span> <span class=o>=</span> <span class=s2>&#34;; &#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>graph_context</span><span class=p>[</span><span class=s2>&#34;edges&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>prompt</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    You are an intelligent assistant with access to the following knowledge graph:
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Nodes: </span><span class=si>{</span><span class=n>nodes_str</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Edges: </span><span class=si>{</span><span class=n>edges_str</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Using this graph, Answer the following question:
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    User Query: &#34;</span><span class=si>{</span><span class=n>user_query</span><span class=si>}</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>chat</span><span class=o>.</span><span class=n>completions</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>model</span><span class=o>=</span><span class=s2>&#34;gpt-4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=s2>&#34;Provide the answer for the following question:&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>prompt</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>choices</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>message</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Error querying LLM: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></div><hr><p>The function graphRAG_run takes the graph context (nodes and edges) and the user query, combining them into a structured prompt for the LLM. The nodes and edges are formatted as readable strings to form part of the LLM input. The LLM is then queried with the generated prompt, asking it to refine the user query using the graph context and provide an answer. If the model successfully generates a response, it returns the answer.</p><h3 id=end-to-end-pipeline>End-to-End Pipeline</h3><p>Finally, let‚Äôs integrate everything into an end-to-end pipeline where we ingest some sample data, run the retrieval process, and query the language model.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Script started&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Loading environment variables...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>load_dotenv</span><span class=p>(</span><span class=s1>&#39;.env.local&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Environment variables loaded&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Initializing clients...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>neo4j_driver</span> <span class=o>=</span> <span class=n>GraphDatabase</span><span class=o>.</span><span class=n>driver</span><span class=p>(</span><span class=n>neo4j_uri</span><span class=p>,</span> <span class=n>auth</span><span class=o>=</span><span class=p>(</span><span class=n>neo4j_username</span><span class=p>,</span> <span class=n>neo4j_password</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>qdrant_client</span> <span class=o>=</span> <span class=n>QdrantClient</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>url</span><span class=o>=</span><span class=n>qdrant_url</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>api_key</span><span class=o>=</span><span class=n>qdrant_key</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Clients initialized&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Creating collection...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>collection_name</span> <span class=o>=</span> <span class=s2>&#34;graphRAGstoreds&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>vector_dimension</span> <span class=o>=</span> <span class=mi>1536</span>
</span></span><span class=line><span class=cl>    <span class=n>create_collection</span><span class=p>(</span><span class=n>qdrant_client</span><span class=p>,</span> <span class=n>collection_name</span><span class=p>,</span> <span class=n>vector_dimension</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Collection created/verified&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Extracting graph components...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>raw_data</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;Alice is a data scientist at TechCorp&#39;s Seattle office.
</span></span></span><span class=line><span class=cl><span class=s2>    Bob and Carol collaborate on the Alpha project.
</span></span></span><span class=line><span class=cl><span class=s2>    Carol transferred to the New York office last year.
</span></span></span><span class=line><span class=cl><span class=s2>    Dave mentors both Alice and Bob.
</span></span></span><span class=line><span class=cl><span class=s2>    TechCorp&#39;s headquarters is in Seattle.
</span></span></span><span class=line><span class=cl><span class=s2>    Carol leads the East Coast team.
</span></span></span><span class=line><span class=cl><span class=s2>    Dave started his career in Seattle.
</span></span></span><span class=line><span class=cl><span class=s2>    The Alpha project is managed from New York.
</span></span></span><span class=line><span class=cl><span class=s2>    Alice previously worked with Carol at DataCo.
</span></span></span><span class=line><span class=cl><span class=s2>    Bob joined the team after Dave&#39;s recommendation.
</span></span></span><span class=line><span class=cl><span class=s2>    Eve runs the West Coast operations from Seattle.
</span></span></span><span class=line><span class=cl><span class=s2>    Frank works with Carol on client relations.
</span></span></span><span class=line><span class=cl><span class=s2>    The New York office expanded under Carol&#39;s leadership.
</span></span></span><span class=line><span class=cl><span class=s2>    Dave&#39;s team spans multiple locations.
</span></span></span><span class=line><span class=cl><span class=s2>    Alice visits Seattle monthly for team meetings.
</span></span></span><span class=line><span class=cl><span class=s2>    Bob&#39;s expertise is crucial for the Alpha project.
</span></span></span><span class=line><span class=cl><span class=s2>    Carol implemented new processes in New York.
</span></span></span><span class=line><span class=cl><span class=s2>    Eve and Dave collaborated on previous projects.
</span></span></span><span class=line><span class=cl><span class=s2>    Frank reports to the New York office.
</span></span></span><span class=line><span class=cl><span class=s2>    TechCorp&#39;s main AI research is in Seattle.
</span></span></span><span class=line><span class=cl><span class=s2>    The Alpha project revolutionized East Coast operations.
</span></span></span><span class=line><span class=cl><span class=s2>    Dave oversees projects in both offices.
</span></span></span><span class=line><span class=cl><span class=s2>    Bob&#39;s contributions are mainly remote.
</span></span></span><span class=line><span class=cl><span class=s2>    Carol&#39;s team grew significantly after moving to New York.
</span></span></span><span class=line><span class=cl><span class=s2>    Seattle remains the technology hub for TechCorp.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>nodes</span><span class=p>,</span> <span class=n>relationships</span> <span class=o>=</span> <span class=n>extract_graph_components</span><span class=p>(</span><span class=n>raw_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Nodes:&#34;</span><span class=p>,</span> <span class=n>nodes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Relationships:&#34;</span><span class=p>,</span> <span class=n>relationships</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Ingesting to Neo4j...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>node_id_mapping</span> <span class=o>=</span> <span class=n>ingest_to_neo4j</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>relationships</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Neo4j ingestion complete&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Ingesting to Qdrant...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ingest_to_qdrant</span><span class=p>(</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>raw_data</span><span class=p>,</span> <span class=n>node_id_mapping</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Qdrant ingestion complete&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=s2>&#34;How is Bob connected to New York?&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Starting retriever search...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>retriever_result</span> <span class=o>=</span> <span class=n>retriever_search</span><span class=p>(</span><span class=n>neo4j_driver</span><span class=p>,</span> <span class=n>qdrant_client</span><span class=p>,</span> <span class=n>collection_name</span><span class=p>,</span> <span class=n>query</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Retriever results:&#34;</span><span class=p>,</span> <span class=n>retriever_result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Extracting entity IDs...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>entity_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>item</span><span class=o>.</span><span class=n>content</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;&#39;id&#39;: &#39;&#34;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;&#39;&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>retriever_result</span><span class=o>.</span><span class=n>items</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Entity IDs:&#34;</span><span class=p>,</span> <span class=n>entity_ids</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Fetching related graph...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>subgraph</span> <span class=o>=</span> <span class=n>fetch_related_graph</span><span class=p>(</span><span class=n>neo4j_driver</span><span class=p>,</span> <span class=n>entity_ids</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Subgraph:&#34;</span><span class=p>,</span> <span class=n>subgraph</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Formatting graph context...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>graph_context</span> <span class=o>=</span> <span class=n>format_graph_context</span><span class=p>(</span><span class=n>subgraph</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Graph context:&#34;</span><span class=p>,</span> <span class=n>graph_context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Running GraphRAG...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>answer</span> <span class=o>=</span> <span class=n>graphRAG_run</span><span class=p>(</span><span class=n>graph_context</span><span class=p>,</span> <span class=n>query</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Final Answer:&#34;</span><span class=p>,</span> <span class=n>answer</span><span class=p>)</span>
</span></span></code></pre></div><hr><p>Here‚Äôs what‚Äôs happening:</p><ul><li>First, the user query is defined (&ldquo;How is Bob connected to New York?&rdquo;).</li><li>The QdrantNeo4jRetriever searches for related entities in the Qdrant vector database based on the user query‚Äôs embedding. It retrieves the top 5 results (top_k=5).</li><li>The entity_ids are extracted from the retriever result.</li><li>The fetch_related_graph function retrieves related entities and their relationships from the Neo4j database.</li><li>The format_graph_context function prepares the graph data in a format the LLM can understand.</li><li>Finally, the graphRAG_run function is called to generate and query the language model, producing an answer based on the retrieved graph context.</li></ul><p>With this, we have successfully created GraphRAG, a system capable of capturing complex relationships and delivering improved performance compared to the baseline RAG approach.</p><h1 id=advantages-of-qdrant--neo4j-graphrag>Advantages of Qdrant + Neo4j GraphRAG</h1><p>Combining Qdrant with Neo4j in a GraphRAG architecture offers several compelling advantages, particularly regarding recall and precision combo, contextual understanding, adaptability to complex queries, and better cost and scalability.</p><ol><li><strong>Improved Recall and Precision:</strong> By leveraging Qdrant, a highly efficient vector search engine, alongside Neo4j‚Äôs robust graph database, the system benefits from both semantic search and relationship-based retrieval. Qdrant identifies relevant vectors and captures the similarity between queries and stored data. At the same time, Neo4j adds a layer of connectivity through its graph structure, ensuring that relevant and contextually linked information is retrieved. This combination improves recall (retrieving a broader set of relevant results) and precision (delivering more accurate and contextually relevant results), addressing a common challenge in traditional retrieval-based AI systems.</li><li><strong>Enhanced Contextual Understanding:</strong> Neo4j enhances contextual understanding by representing information as a graph, where entities and their relationships are naturally modeled. When integrated with Qdrant, the system can retrieve similar items based on vector embeddings and those that fit within the desired relational context, leading to more nuanced and meaningful responses.</li><li><strong>Adaptability to Complex Queries:</strong> Combining Qdrant and Neo4j makes the system highly adaptable to complex queries. While Qdrant handles the vector search for relevant data, Neo4j‚Äôs graph capabilities enable sophisticated querying through relationships. This allows for multi-hop reasoning and handling complex, structured queries that would be challenging for traditional search engines.</li><li><strong>Better Cost & Scalability:</strong> GraphRAG, on its own, demands significant resources, as it relies on LLMs to construct and query knowledge graphs. It also employs clustering algorithms to create semantic clusters for local searches. These can hinder scalability and increase costs. Qdrant addresses the issue of local search through vector search, while Neo4j‚Äôs knowledge graph is queried for more precise answers, enhancing both efficiency and accuracy. Furthermore, instead of using an LLM, Named Entity Recognition (NER)-based techniques can reduce the cost further, but it depends mainly on the dataset.</li></ol><h1 id=conclusion>Conclusion</h1><p>GraphRAG with Neo4j and Qdrant marks an important step forward in retrieval-augmented generation. This hybrid approach delivers significant advantages by combining vector search and graph databases. Qdrant&rsquo;s semantic search capabilities enhance recall accuracy, while Neo4j&rsquo;s relationship modeling provides deeper context understanding.</p><p>The implementation template we&rsquo;ve explored offers a foundation for your projects. You can adapt and customize it based on your specific needs, whether for document analysis, knowledge management, or other information retrieval tasks.</p><p>As AI systems evolve, this combination of technologies shows how we can build smarter, more efficient solutions. We encourage you to experiment with this approach and discover how it can enhance your applications.</p></article><section class="docs-feedback d-print-none"><h5 class=docs-feedback__title>Was this page useful?</h5><div class=docs-feedback__buttons><button class="button button_outlined button_sm docs-feedback__button" id=feedback__answer_yes>
<img src=https://qdrant.tech/icons/outline/thumb-up.svg alt="Thumb up icon">
Yes
</button>
<button class="button button_outlined button_sm docs-feedback__button" id=feedback__answer_no>
<img src=https://qdrant.tech/icons/outline/thumb-down.svg alt="Thumb down icon">
No</button></div></section><section class="docs-feedback__responses d-none"><p class="docs-feedback__response docs-feedback__response_yes" id=feedback__response_yes>Thank you for your feedback! üôè</p><p class="docs-feedback__response docs-feedback__response_no" id=feedback__response_no>We are sorry to hear that. üòî You can <a class=text-brand-p href=https:/github.com/qdrant/landing_page/tree/master/qdrant-landing/content/documentation/examples/graphrag-qdrant-neo4j.md target=_blank>edit</a> this page on GitHub, or <a class=text-brand-p href=https://github.com/qdrant/landing_page/issues/new/choose target=_blank>create</a> a GitHub issue.</p></section><script>const buttonsSection=document.querySelector(".docs-feedback"),responsesSection=document.querySelector(".docs-feedback__responses"),yesButton=document.querySelector("#feedback__answer_yes"),noButton=document.querySelector("#feedback__answer_no"),yesResponse=document.querySelector("#feedback__response_yes"),noResponse=document.querySelector("#feedback__response_no"),toggleResponses=()=>{buttonsSection.classList.add("d-none"),responsesSection.classList.remove("d-none")};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback__response_visible"),toggleResponses()}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback__response_visible"),toggleResponses()})</script></div><div class=table-of-contents><p class=table-of-contents__head>On this page:</p><nav id=TableOfContents><ul><li><a href=#build-a-graphrag-agent-with-neo4j-and-qdrant>Build a GraphRAG Agent with Neo4j and Qdrant</a><ul><li><a href=#watch-the-video>Watch the Video</a></li></ul></li><li><a href=#rag--its-challenges>RAG & Its Challenges</a></li><li><a href=#introduction-to-graphrag>Introduction to GraphRAG</a><ul><li><ul><li><a href=#challenges-of-graphrag>Challenges of GraphRAG</a></li></ul></li></ul></li><li><a href=#architecture-overview>Architecture Overview</a><ul><li><a href=#ingestion>Ingestion</a></li><li><a href=#retrieval--generation>Retrieval & Generation</a></li></ul></li><li><a href=#implementation>Implementation</a><ul><li><a href=#prerequisites>Prerequisites</a><ul><li><a href=#setup>Setup</a></li><li><a href=#qdrant-setup>Qdrant Setup</a></li><li><a href=#neo4j-setup>Neo4j Setup</a></li><li><a href=#imports>Imports</a></li><li><a href=#setting-up-environment-variables>Setting Up Environment Variables</a></li><li><a href=#initializing-neo4j-and-qdrant-clients>Initializing Neo4j and Qdrant Clients</a></li></ul></li><li><a href=#ingestion-1>Ingestion</a><ul><li><a href=#defining-output-parser>Defining Output Parser</a></li><li><a href=#defining-openai-client-and-llm-parser-function>Defining OpenAI Client and LLM Parser Function</a></li><li><a href=#extracting-graph-components>Extracting Graph Components</a></li><li><a href=#ingesting-data-to-neo4j>Ingesting Data to Neo4j</a></li><li><a href=#creating-qdrant-collection>Creating Qdrant Collection</a></li><li><a href=#generating-embeddings>Generating Embeddings</a></li><li><a href=#ingesting-into-qdrant>Ingesting into Qdrant</a></li></ul></li><li><a href=#retrieval--generation-1>Retrieval & Generation</a><ul><li><a href=#building-a-retriever>Building a Retriever</a></li><li><a href=#querying-neo4j-for-related-graph-data>Querying Neo4j for Related Graph Data</a></li><li><a href=#setting-up-the-graph-context>Setting up the Graph Context</a></li><li><a href=#integrating-with-the-llm>Integrating with the LLM</a></li><li><a href=#end-to-end-pipeline>End-to-End Pipeline</a></li></ul></li></ul></li><li><a href=#advantages-of-qdrant--neo4j-graphrag>Advantages of Qdrant + Neo4j GraphRAG</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav><ul class=table-of-contents__external-links><li class=table-of-contents__link><a href=https://github.com/qdrant/landing_page/tree/master/qdrant-landing/content/documentation/examples/graphrag-qdrant-neo4j.md target=_blank><svg width="16" height="17" viewBox="0 0 16 17" fill="none"><g clip-path="url(#clip0_6269_955)"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 .700012c-4.4.0-8 3.599998-8 7.999998C0 12.2333 2.26667 15.2333 5.46667 16.3 5.86667 16.3667 6 16.1 6 15.9S6 15.2333 6 14.5667C3.8 15.0333 3.33333 13.5 3.33333 13.5 3 12.5667 2.46667 12.3 2.46667 12.3 1.66667 11.8333 2.46667 11.8333 2.46667 11.8333 3.26667 11.9 3.66667 12.6333 3.66667 12.6333 4.4 13.8333 5.53333 13.5 6 13.3 6.06667 12.7667 6.26667 12.4333 6.53333 12.2333 4.73333 12.0333 2.86667 11.3667 2.86667 8.30001c0-.86666.33333-1.6.8-2.13333.0-.26667-.33334-1.06667.13333-2.13333.0.0.66667-.200000000000001 2.2.8.66667-.2 1.33333-.26667 2-.26667S9.33333 4.63335 10 4.83335c1.5333-1.06667 2.2-.8 2.2-.8C12.6667 5.16668 12.3333 5.96668 12.2667 6.16668 12.8 6.70001 13.0667 7.43335 13.0667 8.30001c0 3.06669-1.8667 3.73329-3.6667 3.93329C9.66667 12.5 9.93333 12.9667 9.93333 13.7c0 1.0667.0 1.9333.0 2.2C9.93333 16.1 10.0667 16.3667 10.4667 16.3c3.2-1.0667 5.4666-4.0667 5.4666-7.59999C16 4.30001 12.4.700012 8 .700012z" fill="#f0f3fa"/></g><defs><clipPath id="clip0_6269_955"><rect width="16" height="16" fill="#fff" transform="translate(0 0.5)"/></clipPath></defs></svg>
Edit on Github</a></li><li class=table-of-contents__link><a href=https://github.com/qdrant/landing_page/issues/new/choose target=_blank><svg width="16" height="17" viewBox="0 0 16 17" fill="none"><g clip-path="url(#clip0_6269_1540)"><path d="M16 9.83331V8.49998H13.9347C13.79 7.33465 13.3947 6.24065 12.8 5.31065l1.476-1.478L13.3327 2.89065 11.9633 4.26198c-.24-.248-.496600000000001-.474-.772-.676C11.0967 3.25665 10.9507 2.95398 10.7673 2.67598l1.038-1.038L10.8627.695312 9.82867 1.72931C9.29867 1.37798 8.672 1.16665 8 1.16665c-.672.0-1.29867.21133-1.828.56266L5.138.695312l-.94267.942668 1.038 1.038c-.18333.27733-.32933.58-.424.90867-.27533.202-.532.42933-.77266.67733L2.66733 2.89065l-.94333.942L3.2 5.30998c-.59467.93-.99 2.02467-1.13467 3.19H0V9.83331H2.01467C2.07333 11.276 2.50533 12.6026 3.204 13.688l-1.48 1.478L2.666 16.1093l1.37-1.368C4.93733 15.67 6.07667 16.288 7.33333 16.452V6.49998H8.66667V16.452C9.92333 16.2873 11.0627 15.67 11.964 14.7413l1.37 1.368L14.276 15.166l-1.48-1.478C13.4947 12.602 13.9267 11.2753 13.9853 9.83331H16z" fill="#f0f3fa"/></g><defs><clipPath id="clip0_6269_1540"><rect width="16" height="16" fill="#fff" transform="translate(0 0.5)"/></clipPath></defs></svg>
Create an issue</a></li></ul></div><footer class="docs-footer w-100 py-0 pt-0 pb-4 pb-xl-0"><div class=docs-footer__cta><h4>Ready to get started with Qdrant?</h4><a href=https://qdrant.to/cloud/ class="button button_outlined button_sm" target=_blank>Start Free</a></div><div class=docs-footer__bottom><div class=docs-footer__bottom-content><span>¬© 2025 Qdrant.</span><div class=footer__bottom-links><a href=https://qdrant.tech/legal/terms_and_conditions/>Terms</a>
<a href=https://qdrant.tech/legal/privacy-policy/>Privacy Policy</a>
<a href=https://qdrant.tech/legal/impressum/>Impressum</a></div></div></div></footer></div></div></div></div></section></main></body><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js type=text/javascript data-domain-script=01960152-5e40-782d-af01-f7f5768a214e></script><script async type=text/javascript>function OptanonWrapper(){const e=new CustomEvent("onetrust_loaded");document.dispatchEvent(e)}</script><script>!function(){const o="eQYi1nZE2zQSmnHuxjMRlDd2uLl65oHe";var n,s,t="analytics",e=window[t]=window[t]||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","screen","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware","register"],e.factory=function(n){return function(){if(window[t].initialized)return window[t][n].apply(window[t],arguments);var o,s=Array.prototype.slice.call(arguments);return["track","screen","alias","group","page","identify"].indexOf(n)>-1&&(o=document.querySelector("link[rel='canonical']"),s.push({__t:"bpc",c:o&&o.getAttribute("href")||void 0,p:location.pathname,u:location.href,s:location.search,t:document.title,r:document.referrer})),s.unshift(n),e.push(s),e}};for(n=0;n<e.methods.length;n++)s=e.methods[n],e[s]=e.factory(s);e.load=function(n,s){var i,o=document.createElement("script");o.type="text/javascript",o.async=!0,o.setAttribute("data-global-segment-analytics-key",t),o.src="https://evs.analytics.qdrant.tech/5caWuitPgcGFN5Q7HMpTaj/vEkmzjuRSqeXGbhGAFTWex.min.js",i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(o,i),e._loadOptions=s},e._writeKey=o,e._cdn="https://evs.analytics.qdrant.tech",e.SNIPPET_VERSION="5.2.0",e.load(o)}}()</script><script src=https://qdrant.tech/js/google-setup.min.14728a3ae9bd931593645b6ddbfe801d400cd2970006e782cb67f3966654248ca962dbaf4cf371493a2d326861b3a691a99d6d8349c8b2752339ab91d3787069.js></script><script src=https://qdrant.tech/js/index.min.e37feda1952d752f5568e1ebc55e183629e4d361f4df09edeed70b4a4327d601161c4147bdbe4149b4a3cdc1ed43f1bf1a2f2340a421f1aa821103980dfe0bda.js></script><script src=https://qdrant.tech/js/search/search.min.e58e7ea98cb549ea9d3ed7e68876abe323cfb323432038820f38a71c40e309deed0fba615e2d3346825229a81e0a76bbadf6f8a816ddad3438abdabfef4ebc09.js type=module></script><script src=https://qdrant.tech/js/search/scroll.min.f4ed4453a3af0adb0d4f49333cbb7892ff5430483a567d0d2dfbd4655fb203d22f22f46aff3d9f38fa5fd96dde5f30227afd0ce1d9f838f5cd5295fc83856ec9.js></script><script src=https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js></script><script src=https://qdrant.tech/js/copy-code.min.95b03a45b2ab4b7a608ecfd4b5919c8572a5b2cd1463f52561cd10976abf3b74334f91324c0e620cb80afac46026a0b18cce6fb753d8495f74c6d478c8ca1d03.js></script><script src=https://qdrant.tech/js/lang-switcher.min.63da11cef09772078425b1ee56415b9c37842a9399f2ba2d2f5efbf72fb751686c410bd50e9bcd283c8231cb97c1973199d4923beef29d8b06e59d9983a6ba51.js></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src=https://qdrant.tech/js/vendor/anchor.min.0e138e17ebcf1c1147a7a3a81d9ac3c601622eedc479f1636470eb2552470f4e27c9a8efe6e8378995dedc1ab67029d8989536ea76f0857d45d1615ae772b8a1.js></script><script>document.addEventListener("keydown",function(e){if((e.metaKey||e.ctrlKey)&&e.key==="k"){e.preventDefault();let t=document.querySelector('[data-target="#searchModal"]');t&&t?.click()}})</script><script>window.addEventListener("message",e=>{if(e.data.type==="hsFormCallback"&&e.data.eventName==="onFormReady"){const t=document.querySelector(`form[data-form-id="${e.data.id}"]`);if(t){const e=t.querySelector('[name="last_form_fill_url"]');e&&(e.value=window.location.href);const n=t.querySelector('[name="referrer_url"]');n&&(n.value=document.referrer)}}})</script></html>